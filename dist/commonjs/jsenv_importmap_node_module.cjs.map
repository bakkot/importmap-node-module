{
  "version": 3,
  "file": "jsenv_importmap_node_module.cjs",
  "sources": [
    "../../src/internal/assertInitialImportMap.js",
    "../../src/internal/package_conditions.js",
    "../../src/internal/logs.js",
    "../../src/internal/resolveFile.js",
    "../../src/internal/from-package/resolvePackageMain.js",
    "../../src/internal/from-package/visitPackageImportMap.js",
    "../../src/internal/from-package/specifierIsRelative.js",
    "../../src/internal/from-package/visitPackageImports.js",
    "../../src/internal/from-package/visitPackageExports.js",
    "../../src/internal/memoizeAsyncFunction.js",
    "../../src/internal/from-package/readPackageFile.js",
    "../../src/internal/from-package/applyPackageManualOverride.js",
    "../../src/internal/from-package/node-module-resolution.js",
    "../../src/internal/from-package/visitNodeModuleResolution.js",
    "../../src/internal/optimizeImportMap.js",
    "../../src/internal/from-js/resolveProjectEntryPoint.js",
    "../../node_modules/@jsenv/core/helpers/import-meta/import-meta-url-commonjs.js",
    "../../src/internal/from-js/parseImportSpecifiers.js",
    "../../src/internal/from-js/showSource.js",
    "../../src/internal/from-js/visitSourceFiles.js",
    "../../src/internal/importMapToVsCodeConfigPaths.js",
    "../../src/writeImportMapFiles.js"
  ],
  "sourcesContent": [
    "export const assertInitialImportMap = (value) => {\n  if (value === null) {\n    throw new TypeError(`initialImportMap must be an object, got null`)\n  }\n\n  const type = typeof value\n  if (type !== \"object\") {\n    throw new TypeError(`initialImportMap must be an object, received ${value}`)\n  }\n\n  const { imports = {}, scopes = {}, ...rest } = value\n  const extraKeys = Object.keys(rest)\n  if (extraKeys.length > 0) {\n    throw new TypeError(\n      `initialImportMap can have \"imports\" and \"scopes\", found unexpected keys ${extraKeys}`,\n    )\n  }\n\n  if (typeof imports !== \"object\") {\n    throw new TypeError(\n      `initialImportMap.imports must be an object, found ${imports}`,\n    )\n  }\n\n  if (typeof scopes !== \"object\") {\n    throw new TypeError(\n      `initialImportMap.scopes must be an object, found ${imports}`,\n    )\n  }\n}\n",
    "export const packageConditionsFromPackageUserConditions = ({\n  runtime,\n  packageUserConditions,\n}) => {\n  if (typeof packageUserConditions === \"undefined\") {\n    return [\"import\", runtime, \"default\"]\n  }\n\n  if (!Array.isArray(packageUserConditions)) {\n    throw new TypeError(\n      `packageUserConditions must be an array, got ${packageUserConditions}`,\n    )\n  }\n\n  packageUserConditions.forEach((userCondition) => {\n    if (typeof userCondition !== \"string\") {\n      throw new TypeError(\n        `user condition must be a string, got ${userCondition}`,\n      )\n    }\n  })\n\n  return [...packageUserConditions, \"import\", runtime, \"default\"]\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport {\n  urlToFileSystemPath,\n  urlToRelativeUrl,\n  resolveUrl,\n} from \"@jsenv/filesystem\"\n\nexport const createPackageNameMustBeAStringWarning = ({\n  packageName,\n  packageInfo,\n}) => {\n  return {\n    code: \"PACKAGE_NAME_MUST_BE_A_STRING\",\n    message: `Package name field must be a string\n--- package name field ---\n${packageName}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n\nexport const createImportResolutionFailedWarning = ({\n  specifier,\n  importedBy,\n  gotBareSpecifierError,\n  magicExtension,\n  suggestsNodeRuntime,\n  automapping,\n}) => {\n  return {\n    code: \"IMPORT_RESOLUTION_FAILED\",\n    message: createDetailedMessage(\n      `Import resolution failed for \"${specifier}\"`,\n      {\n        \"import source\": importedBy,\n        \"reason\": gotBareSpecifierError\n          ? `there is no mapping for this bare specifier`\n          : `file not found on filesystem`,\n        ...getImportResolutionFailedSuggestions({\n          suggestsNodeRuntime,\n          gotBareSpecifierError,\n          magicExtension,\n          automapping,\n        }),\n        // \"extensions tried\": magicExtensions.join(`, `),\n      },\n    ),\n  }\n}\n\nexport const createBareSpecifierAutomappingMessage = ({\n  specifier,\n  importedBy,\n  automapping,\n}) => {\n  return createDetailedMessage(`Auto mapping for \"${specifier}\"`, {\n    \"import source\": importedBy,\n    \"mapping\": mappingToImportmapString(automapping),\n    \"reason\": `bare specifier and \"bareSpecifierAutomapping\" enabled`,\n  })\n}\n\nexport const createExtensionLessAutomappingMessage = ({\n  specifier,\n  importedBy,\n  automapping,\n  mappingFoundInPackageExports,\n}) => {\n  return createDetailedMessage(`Auto mapping for \"${specifier}\"`, {\n    \"import source\": importedBy,\n    \"mapping\": mappingToImportmapString(automapping),\n    \"reason\": mappingFoundInPackageExports\n      ? `no file extension and mapping found in package exports`\n      : `no file extension and \"bareSpecifierAutomapping\" enabled`,\n  })\n}\n\nconst getImportResolutionFailedSuggestions = ({\n  suggestsNodeRuntime,\n  gotBareSpecifierError,\n  magicExtension,\n  automapping,\n}) => {\n  const suggestions = {}\n\n  const addSuggestion = (suggestion) => {\n    const suggestionCount = Object.keys(suggestions).length\n    suggestions[`suggestion ${suggestionCount + 1}`] = suggestion\n  }\n\n  if (suggestsNodeRuntime) {\n    addSuggestion(`use runtime: \"node\"`)\n  }\n  if (automapping) {\n    addSuggestion(\n      `update import specifier to \"${mappingToUrlRelativeToFile(automapping)}\"`,\n    )\n    if (gotBareSpecifierError) {\n      addSuggestion(`use bareSpecifierAutomapping: true`)\n    }\n    if (magicExtension) {\n      addSuggestion(`use extensionlessAutomapping: true`)\n    }\n    addSuggestion(`add mapping to \"initialImportMap\"\n${mappingToImportmapString(automapping)}`)\n  }\n\n  return suggestions\n}\n\nconst mappingToUrlRelativeToFile = (mapping) => {\n  if (!mapping.scope) {\n    return mapping.to\n  }\n  const scopeUrl = resolveUrl(mapping.scope, \"file:///\")\n  const toUrl = resolveUrl(mapping.to, \"file:///\")\n  return `./${urlToRelativeUrl(toUrl, scopeUrl)}`\n}\n\nconst mappingToImportmapString = ({ scope, from, to }) => {\n  if (scope) {\n    return JSON.stringify(\n      {\n        scopes: {\n          [scope]: {\n            [from]: to,\n          },\n        },\n      },\n      null,\n      \"  \",\n    )\n  }\n\n  return JSON.stringify(\n    {\n      imports: {\n        [from]: to,\n      },\n    },\n    null,\n    \"  \",\n  )\n}\n\n// const mappingToExportsFieldString = ({ scope, from, to }) => {\n//   if (scope) {\n//     const scopeUrl = resolveUrl(scope, \"file://\")\n//     const toUrl = resolveUrl(to, \"file://\")\n//     to = `./${urlToRelativeUrl(toUrl, scopeUrl)}`\n//   }\n\n//   return JSON.stringify(\n//     {\n//       exports: {\n//         [from]: to,\n//       },\n//     },\n//     null,\n//     \"  \",\n//   )\n// }\n",
    "import {\n  resolveUrl,\n  readFileSystemNodeStat,\n  urlToFilename,\n  urlToExtension,\n} from \"@jsenv/filesystem\"\nimport { firstOperationMatching } from \"@jsenv/cancellation\"\n\nexport const resolveFile = async (\n  fileUrl,\n  { magicDirectoryIndexEnabled, magicExtensionEnabled, magicExtensions },\n) => {\n  const fileStat = await readFileSystemNodeStat(fileUrl, {\n    nullIfNotFound: true,\n  })\n\n  // file found\n  if (fileStat && fileStat.isFile()) {\n    return {\n      found: true,\n      url: fileUrl,\n    }\n  }\n\n  // directory found\n  if (fileStat && fileStat.isDirectory()) {\n    if (magicDirectoryIndexEnabled) {\n      const indexFileSuffix = fileUrl.endsWith(\"/\") ? \"index\" : \"/index\"\n      const indexFileUrl = `${fileUrl}${indexFileSuffix}`\n      const result = await resolveFile(indexFileUrl, {\n        magicExtensionEnabled,\n        magicDirectoryIndexEnabled: false,\n        magicExtensions,\n      })\n      return {\n        magicDirectoryIndex: true,\n        ...result,\n      }\n    }\n\n    return {\n      found: false,\n      url: fileUrl,\n    }\n  }\n\n  if (!magicExtensionEnabled) {\n    return {\n      found: false,\n      url: fileUrl,\n    }\n  }\n\n  // file already has an extension, magic extension cannot be used\n  const extension = urlToExtension(fileUrl)\n  if (extension !== \"\") {\n    return {\n      found: false,\n      url: fileUrl,\n    }\n  }\n\n  const extensionLeadingToAFile = await findExtensionLeadingToFile(\n    fileUrl,\n    magicExtensions,\n  )\n  // magic extension not found\n  if (extensionLeadingToAFile === null) {\n    return {\n      found: false,\n      url: fileUrl,\n    }\n  }\n  // magic extension worked\n  return {\n    magicExtension: extensionLeadingToAFile,\n    found: true,\n    url: `${fileUrl}${extensionLeadingToAFile}`,\n  }\n}\n\nconst findExtensionLeadingToFile = async (fileUrl, magicExtensions) => {\n  const urlDirectoryUrl = resolveUrl(\"./\", fileUrl)\n  const urlFilename = urlToFilename(fileUrl)\n  const extensionLeadingToFile = await firstOperationMatching({\n    array: magicExtensions,\n    start: async (extensionCandidate) => {\n      const urlCandidate = `${urlDirectoryUrl}${urlFilename}${extensionCandidate}`\n      const stats = await readFileSystemNodeStat(urlCandidate, {\n        nullIfNotFound: true,\n      })\n      return stats && stats.isFile() ? extensionCandidate : null\n    },\n    predicate: (extension) => Boolean(extension),\n  })\n  return extensionLeadingToFile || null\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport {\n  resolveUrl,\n  urlToFileSystemPath,\n  urlToExtension,\n  urlToRelativeUrl,\n} from \"@jsenv/filesystem\"\n\nimport { resolveFile } from \"../resolveFile.js\"\n\nexport const resolvePackageMain = async ({\n  packageInfo,\n  // nodeResolutionConditions = [],\n}) => {\n  const packageMain = packageInfo.object.main\n  // main is explicitely empty meaning\n  // it is assumed that we should not find a file\n  if (packageMain === \"\") {\n    return { found: false }\n  }\n\n  const relativeUrlToTry = packageMain\n    ? packageMain.endsWith(\"/\")\n      ? `${packageMain}index`\n      : packageMain\n    : \"./index\"\n  const urlFirstCandidate = resolveUrl(relativeUrlToTry, packageInfo.url)\n  const packageDirectoryUrl = resolveUrl(\"./\", packageInfo.url)\n\n  if (!urlFirstCandidate.startsWith(packageDirectoryUrl)) {\n    return {\n      found: false,\n      warning: createPackageMainFileMustBeRelativeWarning({\n        packageMain,\n        packageInfo,\n      }),\n    }\n  }\n\n  const { found, url } = await resolveFile(urlFirstCandidate, {\n    magicDirectoryIndexEnabled: true,\n    magicExtensionEnabled: true,\n    magicExtensions: [\".js\", \".json\", \".node\"],\n  })\n\n  if (!found) {\n    const warning = createPackageMainFileNotFoundWarning({\n      specifier: relativeUrlToTry,\n      packageInfo,\n      fileUrl: urlFirstCandidate,\n      magicExtensions: [\".js\", \".json\", \".node\"],\n    })\n\n    return {\n      found: false,\n      relativeUrl: urlToRelativeUrl(urlFirstCandidate, packageInfo.url),\n      warning,\n    }\n  }\n\n  return {\n    found: true,\n    relativeUrl: urlToRelativeUrl(url, packageInfo.url),\n  }\n}\n\nconst createPackageMainFileMustBeRelativeWarning = ({\n  packageMain,\n  packageInfo,\n}) => {\n  return {\n    code: \"PACKAGE_MAIN_FILE_MUST_BE_RELATIVE\",\n    message: `\"main\" field in package.json must be inside package.json folder.\n--- main ---\n${packageMain}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n\nconst createPackageMainFileNotFoundWarning = ({\n  specifier,\n  packageInfo,\n  fileUrl,\n  magicExtensions,\n}) => {\n  return {\n    code: \"PACKAGE_MAIN_FILE_NOT_FOUND\",\n    message: createDetailedMessage(\n      `Cannot find package main file \"${specifier}\"`,\n      {\n        \"package.json path\": urlToFileSystemPath(packageInfo.url),\n        ...(urlToExtension(fileUrl) === \"\"\n          ? { [\"extensions tried\"]: magicExtensions.join(`, `) }\n          : {}),\n      },\n    ),\n  }\n}\n",
    "import { resolveUrl, moveImportMap } from \"@jsenv/importmap\"\nimport { readFile, urlToFileSystemPath } from \"@jsenv/filesystem\"\n\nexport const visitPackageImportMap = async ({\n  warn,\n  packageInfo,\n  packageImportmap = packageInfo.object.importmap,\n  projectDirectoryUrl,\n}) => {\n  if (typeof packageImportmap === \"undefined\") {\n    return {}\n  }\n\n  if (typeof packageImportmap === \"string\") {\n    const importmapFileUrl = resolveUrl(packageImportmap, packageInfo.url)\n    try {\n      const importmap = await readFile(importmapFileUrl, { as: \"json\" })\n      return moveImportMap(importmap, importmapFileUrl, projectDirectoryUrl)\n    } catch (e) {\n      if (e.code === \"ENOENT\") {\n        warn(\n          createPackageImportMapNotFoundWarning({\n            importmapFileUrl,\n            packageInfo,\n          }),\n        )\n        return {}\n      }\n      throw e\n    }\n  }\n\n  if (typeof packageImportmap === \"object\" && packageImportmap !== null) {\n    return packageImportmap\n  }\n\n  warn(\n    createPackageImportMapUnexpectedWarning({\n      packageImportmap,\n      packageInfo,\n    }),\n  )\n  return {}\n}\n\nconst createPackageImportMapNotFoundWarning = ({\n  importmapFileUrl,\n  packageInfo,\n}) => {\n  return {\n    code: \"PACKAGE_IMPORTMAP_NOT_FOUND\",\n    message: `importmap file specified in a package.json cannot be found,\n--- importmap file path ---\n${importmapFileUrl}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n\nconst createPackageImportMapUnexpectedWarning = ({\n  packageImportmap,\n  packageInfo,\n}) => {\n  return {\n    code: \"PACKAGE_IMPORTMAP_UNEXPECTED\",\n    message: `unexpected value in package.json importmap field: value must be a string or an object.\n--- value ---\n${packageImportmap}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n",
    "export const specifierIsRelative = (specifier) => {\n  if (specifier.startsWith(\"//\")) {\n    return false\n  }\n  if (specifier.startsWith(\"../\")) {\n    return false\n  }\n  // starts with http:// or file:// or ftp: for instance\n  if (/^[a-zA-Z]+\\:/.test(specifier)) {\n    return false\n  }\n  return true\n}\n",
    "/*\n\nhttps://nodejs.org/docs/latest-v15.x/api/packages.html#packages_node_js_package_json_field_definitions\n\n*/\n\nimport { urlToFileSystemPath } from \"@jsenv/filesystem\"\nimport { specifierIsRelative } from \"./specifierIsRelative.js\"\n\nexport const visitPackageImports = ({\n  warn,\n  packageInfo,\n  packageImports = packageInfo.object.imports,\n  packageConditions,\n}) => {\n  const importsSubpaths = {}\n  const onImportsSubpath = ({ key, value, trace }) => {\n    if (!specifierIsRelative(value)) {\n      warn(\n        createSubpathValueMustBeRelativeWarning({\n          value,\n          valueTrace: trace,\n          packageInfo,\n        }),\n      )\n      return\n    }\n\n    const keyNormalized = key\n    const valueNormalized = value\n    importsSubpaths[keyNormalized] = valueNormalized\n  }\n\n  const visitSubpathValue = (subpathValue, subpathValueTrace) => {\n    if (typeof subpathValue === \"string\") {\n      return handleString(subpathValue, subpathValueTrace)\n    }\n\n    if (typeof subpathValue === \"object\" && subpathValue !== null) {\n      return handleObject(subpathValue, subpathValueTrace)\n    }\n\n    return handleRemaining(subpathValue, subpathValueTrace)\n  }\n\n  const handleString = (subpathValue, subpathValueTrace) => {\n    const firstBareKey = subpathValueTrace\n      .slice()\n      .reverse()\n      .find((key) => key.startsWith(\"#\"))\n    onImportsSubpath({\n      key: firstBareKey,\n      value: subpathValue,\n      trace: subpathValueTrace,\n    })\n    return true\n  }\n\n  const handleObject = (subpathValue, subpathValueTrace) => {\n    // From Node.js documentation:\n    // \"If a nested conditional does not have any mapping it will continue\n    // checking the remaining conditions of the parent condition\"\n    // https://nodejs.org/docs/latest-v14.x/api/packages.html#packages_nested_conditions\n    //\n    // So it seems what we do here is not sufficient\n    // -> if the condition finally does not lead to something\n    // it should be ignored and an other branch be taken until\n    // something resolves\n    const followConditionBranch = (subpathValue, conditionTrace) => {\n      const bareKeys = []\n      const conditionalKeys = []\n      Object.keys(subpathValue).forEach((availableKey) => {\n        if (availableKey.startsWith(\"#\")) {\n          bareKeys.push(availableKey)\n        } else {\n          conditionalKeys.push(availableKey)\n        }\n      })\n\n      if (bareKeys.length > 0 && conditionalKeys.length > 0) {\n        warn(\n          createSubpathKeysAreMixedWarning({\n            subpathValue,\n            subpathValueTrace: [...subpathValueTrace, ...conditionTrace],\n            packageInfo,\n            bareKeys,\n            conditionalKeys,\n          }),\n        )\n        return false\n      }\n\n      // there is no condition, visit all bare keys (starting with #)\n      if (conditionalKeys.length === 0) {\n        let leadsToSomething = false\n        bareKeys.forEach((key) => {\n          leadsToSomething = visitSubpathValue(subpathValue[key], [\n            ...subpathValueTrace,\n            ...conditionTrace,\n            key,\n          ])\n        })\n        return leadsToSomething\n      }\n\n      // there is a condition, keep the first one leading to something\n      return conditionalKeys.some((keyCandidate) => {\n        if (!packageConditions.includes(keyCandidate)) {\n          return false\n        }\n        const valueCandidate = subpathValue[keyCandidate]\n        return visitSubpathValue(valueCandidate, [\n          ...subpathValueTrace,\n          ...conditionTrace,\n          keyCandidate,\n        ])\n      })\n    }\n\n    return followConditionBranch(subpathValue, [])\n  }\n\n  const handleRemaining = (subpathValue, subpathValueTrace) => {\n    warn(\n      createSubpathIsUnexpectedWarning({\n        subpathValue,\n        subpathValueTrace,\n        packageInfo,\n      }),\n    )\n    return false\n  }\n\n  visitSubpathValue(packageImports, [\"imports\"])\n\n  return importsSubpaths\n}\n\nconst createSubpathIsUnexpectedWarning = ({\n  subpathValue,\n  subpathValueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"IMPORTS_SUBPATH_UNEXPECTED\",\n    message: `unexpected subpath in package.json imports: value must be an object or a string.\n--- value ---\n${subpathValue}\n--- value at ---\n${subpathValueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n\nconst createSubpathKeysAreMixedWarning = ({\n  subpathValue,\n  subpathValueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"IMPORTS_SUBPATH_MIXED_KEYS\",\n    message: `unexpected subpath keys in package.json imports: cannot mix bare and conditional keys.\n--- value ---\n${JSON.stringify(subpathValue, null, \"  \")}\n--- value at ---\n${subpathValueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n\nconst createSubpathValueMustBeRelativeWarning = ({\n  value,\n  valueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"IMPORTS_SUBPATH_VALUE_UNEXPECTED\",\n    message: `unexpected subpath value in package.json imports: value must be relative to package\n--- value ---\n${value}\n--- value at ---\n${valueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}`,\n  }\n}\n",
    "/*\n\nhttps://nodejs.org/docs/latest-v15.x/api/packages.html#packages_node_js_package_json_field_definitions\n\n*/\n\nimport {\n  urlToFileSystemPath,\n  urlToRelativeUrl,\n  resolveUrl,\n} from \"@jsenv/filesystem\"\nimport { specifierIsRelative } from \"./specifierIsRelative.js\"\n\nexport const visitPackageExports = ({\n  projectDirectoryUrl,\n  warn,\n  packageInfo,\n  packageExports = packageInfo.object.exports,\n  packageName = packageInfo.name,\n  packageConditions,\n}) => {\n  const exportsSubpaths = {}\n  const packageDirectoryUrl = resolveUrl(\"./\", packageInfo.url)\n  const packageDirectoryRelativeUrl = urlToRelativeUrl(\n    packageDirectoryUrl,\n    projectDirectoryUrl,\n  )\n  const onExportsSubpath = ({ key, value, trace }) => {\n    if (!specifierIsRelative(value)) {\n      warn(\n        createSubpathValueMustBeRelativeWarning({\n          value,\n          valueTrace: trace,\n          packageInfo,\n        }),\n      )\n      return\n    }\n\n    const keyNormalized = specifierToSource(key, packageName)\n    const valueNormalized = addressToDestination(\n      value,\n      packageDirectoryRelativeUrl,\n    )\n    exportsSubpaths[keyNormalized] = valueNormalized\n  }\n\n  const visitSubpathValue = (subpathValue, subpathValueTrace) => {\n    // false is allowed as alternative to exports: {}\n    if (subpathValue === false) {\n      return handleFalse()\n    }\n\n    if (typeof subpathValue === \"string\") {\n      return handleString(subpathValue, subpathValueTrace)\n    }\n\n    if (subpathValue === null) {\n      return handleNull(subpathValue, subpathValueTrace)\n    }\n\n    if (typeof subpathValue === \"object\") {\n      return handleObject(subpathValue, subpathValueTrace)\n    }\n\n    return handleRemaining(subpathValue, subpathValueTrace)\n  }\n\n  const handleFalse = () => {\n    // nothing to do\n    return true\n  }\n\n  const handleString = (subpathValue, subpathValueTrace) => {\n    const firstRelativeKey = subpathValueTrace\n      .slice()\n      .reverse()\n      .find((key) => key.startsWith(\".\"))\n    const key = firstRelativeKey || \".\"\n    onExportsSubpath({\n      key,\n      value: subpathValue,\n      trace: subpathValueTrace,\n    })\n    return true\n  }\n\n  const handleNull = () => {\n    // see \"null can be used\" in https://nodejs.org/docs/latest-v16.x/api/packages.html#packages_subpath_patterns\n    return false\n  }\n\n  const handleObject = (subpathValue, subpathValueTrace) => {\n    // From Node.js documentation:\n    // \"If a nested conditional does not have any mapping it will continue\n    // checking the remaining conditions of the parent condition\"\n    // https://nodejs.org/docs/latest-v14.x/api/packages.html#packages_nested_conditions\n    //\n    // So it seems what we do here is not sufficient\n    // -> if the condition finally does not lead to something\n    // it should be ignored and an other branch be taken until\n    // something resolves\n    const followConditionBranch = (subpathValue, conditionTrace) => {\n      const relativeKeys = []\n      const conditionalKeys = []\n      Object.keys(subpathValue).forEach((availableKey) => {\n        if (availableKey.startsWith(\".\")) {\n          relativeKeys.push(availableKey)\n        } else {\n          conditionalKeys.push(availableKey)\n        }\n      })\n\n      if (relativeKeys.length > 0 && conditionalKeys.length > 0) {\n        warn(\n          createSubpathKeysAreMixedWarning({\n            subpathValue,\n            subpathValueTrace: [...subpathValueTrace, ...conditionTrace],\n            packageInfo,\n            relativeKeys,\n            conditionalKeys,\n          }),\n        )\n        return false\n      }\n\n      // there is no condition, visit all relative keys\n      if (conditionalKeys.length === 0) {\n        let leadsToSomething = false\n        relativeKeys.forEach((key) => {\n          leadsToSomething = visitSubpathValue(subpathValue[key], [\n            ...subpathValueTrace,\n            ...conditionTrace,\n            key,\n          ])\n        })\n        return leadsToSomething\n      }\n\n      // there is a condition, keep the first one leading to something\n      return conditionalKeys.some((keyCandidate) => {\n        if (!packageConditions.includes(keyCandidate)) {\n          return false\n        }\n        const valueCandidate = subpathValue[keyCandidate]\n        return visitSubpathValue(valueCandidate, [\n          ...subpathValueTrace,\n          ...conditionTrace,\n          keyCandidate,\n        ])\n      })\n    }\n\n    if (Array.isArray(subpathValue)) {\n      subpathValue = exportsObjectFromExportsArray(subpathValue)\n    }\n    return followConditionBranch(subpathValue, [])\n  }\n\n  const handleRemaining = (subpathValue, subpathValueTrace) => {\n    warn(\n      createSubpathIsUnexpectedWarning({\n        subpathValue,\n        subpathValueTrace,\n        packageInfo,\n      }),\n    )\n    return false\n  }\n\n  visitSubpathValue(packageExports, [\"exports\"])\n\n  return exportsSubpaths\n}\n\nconst exportsObjectFromExportsArray = (exportsArray) => {\n  const exportsObject = {}\n\n  exportsArray.forEach((exportValue) => {\n    if (typeof exportValue === \"object\") {\n      Object.assign(exportsObject, exportValue)\n      return\n    }\n    if (typeof exportValue === \"string\") {\n      exportsObject.default = exportValue\n    }\n  })\n\n  return exportsObject\n}\n\nconst specifierToSource = (specifier, packageName) => {\n  if (specifier === \".\") {\n    return packageName\n  }\n\n  if (specifier[0] === \"/\") {\n    return specifier\n  }\n\n  if (specifier.startsWith(\"./\")) {\n    return `${packageName}${specifier.slice(1)}`\n  }\n\n  return `${packageName}/${specifier}`\n}\n\nconst addressToDestination = (address, packageDirectoryRelativeUrl) => {\n  if (address[0] === \"/\") {\n    return address\n  }\n\n  if (address.startsWith(\"./\")) {\n    return `./${packageDirectoryRelativeUrl}${address.slice(2)}`\n  }\n\n  return `./${packageDirectoryRelativeUrl}${address}`\n}\n\nconst createSubpathIsUnexpectedWarning = ({\n  subpathValue,\n  subpathValueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"EXPORTS_SUBPATH_UNEXPECTED\",\n    message: `unexpected subpath in package.json exports: value must be an object or a string.\n--- value ---\n${subpathValue}\n--- value at ---\n${subpathValueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo)}`,\n  }\n}\n\nconst createSubpathKeysAreMixedWarning = ({\n  subpathValue,\n  subpathValueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"EXPORTS_SUBPATH_MIXED_KEYS\",\n    message: `unexpected subpath keys in package.json exports: cannot mix relative and conditional keys.\n--- value ---\n${JSON.stringify(subpathValue, null, \"  \")}\n--- value at ---\n${subpathValueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo)}`,\n  }\n}\n\nconst createSubpathValueMustBeRelativeWarning = ({\n  value,\n  valueTrace,\n  packageInfo,\n}) => {\n  return {\n    code: \"EXPORTS_SUBPATH_VALUE_MUST_BE_RELATIVE\",\n    message: `unexpected subpath value in package.json exports: value must be a relative to the package.\n--- value ---\n${value}\n--- value at ---\n${valueTrace.join(\".\")}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo)}`,\n  }\n}\n",
    "export const memoizeAsyncFunctionByUrl = (fn) => {\n  const cache = {}\n  return memoizeAsyncFunction(fn, {\n    getMemoryEntryFromArguments: ([url]) => {\n      return {\n        get: () => {\n          return cache[url]\n        },\n        set: (promise) => {\n          cache[url] = promise\n        },\n        delete: () => {\n          delete cache[url]\n        },\n      }\n    },\n  })\n}\n\nexport const memoizeAsyncFunctionBySpecifierAndImporter = (fn) => {\n  const importerCache = {}\n  return memoizeAsyncFunction(fn, {\n    getMemoryEntryFromArguments: ([specifier, importer]) => {\n      return {\n        get: () => {\n          const specifierCacheForImporter = importerCache[importer]\n          return specifierCacheForImporter\n            ? specifierCacheForImporter[specifier]\n            : null\n        },\n        set: (promise) => {\n          const specifierCacheForImporter = importerCache[importer]\n          if (specifierCacheForImporter) {\n            specifierCacheForImporter[specifier] = promise\n          } else {\n            importerCache[importer] = {\n              [specifier]: promise,\n            }\n          }\n        },\n        delete: () => {\n          const specifierCacheForImporter = importerCache[importer]\n          if (specifierCacheForImporter) {\n            delete specifierCacheForImporter[specifier]\n          }\n        },\n      }\n    },\n  })\n}\n\nconst memoizeAsyncFunction = (fn, { getMemoryEntryFromArguments }) => {\n  const memoized = async (...args) => {\n    const memoryEntry = getMemoryEntryFromArguments(args)\n    const promiseFromMemory = memoryEntry.get()\n    if (promiseFromMemory) {\n      return promiseFromMemory\n    }\n    const { promise, resolve, reject } = createControllablePromise()\n    memoryEntry.set(promise)\n    let value\n    let error\n    try {\n      value = fn(...args)\n      error = false\n    } catch (e) {\n      value = e\n      error = true\n      memoryEntry.delete()\n    }\n    if (error) {\n      reject(error)\n    } else {\n      resolve(value)\n    }\n    return promise\n  }\n  memoized.isInMemory = (...args) => {\n    return Boolean(getMemoryEntryFromArguments(args).get())\n  }\n  return memoized\n}\n\nconst createControllablePromise = () => {\n  let resolve\n  let reject\n  const promise = new Promise((res, rej) => {\n    resolve = res\n    reject = rej\n  })\n  return { promise, resolve, reject }\n}\n",
    "import { readFile, urlToFileSystemPath } from \"@jsenv/filesystem\"\n\nexport const PACKAGE_NOT_FOUND = {}\nexport const PACKAGE_WITH_SYNTAX_ERROR = {}\n\nexport const readPackageFile = async (packageFileUrl) => {\n  try {\n    const packageObject = await readFile(packageFileUrl, { as: \"json\" })\n    return packageObject\n  } catch (e) {\n    if (e.code === \"ENOENT\") {\n      return PACKAGE_NOT_FOUND\n    }\n\n    if (e.name === \"SyntaxError\") {\n      console.error(\n        formatPackageSyntaxErrorLog({ syntaxError: e, packageFileUrl }),\n      )\n      return PACKAGE_WITH_SYNTAX_ERROR\n    }\n\n    throw e\n  }\n}\n\nconst formatPackageSyntaxErrorLog = ({ syntaxError, packageFileUrl }) => {\n  return `\nerror while parsing package.json.\n--- syntax error message ---\n${syntaxError.message}\n--- package.json path ---\n${urlToFileSystemPath(packageFileUrl)}\n`\n}\n",
    "export const applyPackageManualOverride = (\n  packageObject,\n  packagesManualOverrides,\n) => {\n  const { name, version } = packageObject\n  const overrideKey = Object.keys(packagesManualOverrides).find(\n    (overrideKeyCandidate) => {\n      if (name === overrideKeyCandidate) {\n        return true\n      }\n      if (`${name}@${version}` === overrideKeyCandidate) {\n        return true\n      }\n      return false\n    },\n  )\n  if (overrideKey) {\n    return composeObject(packageObject, packagesManualOverrides[overrideKey])\n  }\n  return packageObject\n}\n\nconst composeObject = (leftObject, rightObject) => {\n  const composedObject = {\n    ...leftObject,\n  }\n  Object.keys(rightObject).forEach((key) => {\n    const rightValue = rightObject[key]\n\n    if (\n      rightValue === null ||\n      typeof rightValue !== \"object\" ||\n      key in leftObject === false\n    ) {\n      composedObject[key] = rightValue\n    } else {\n      const leftValue = leftObject[key]\n      if (leftValue === null || typeof leftValue !== \"object\") {\n        composedObject[key] = rightValue\n      } else {\n        composedObject[key] = composeObject(leftValue, rightValue)\n      }\n    }\n  })\n  return composedObject\n}\n",
    "import { firstOperationMatching } from \"@jsenv/cancellation\"\nimport { urlToRelativeUrl, resolveUrl } from \"@jsenv/filesystem\"\n\nimport { memoizeAsyncFunctionByUrl } from \"../memoizeAsyncFunction.js\"\nimport {\n  readPackageFile,\n  PACKAGE_NOT_FOUND,\n  PACKAGE_WITH_SYNTAX_ERROR,\n} from \"./readPackageFile.js\"\nimport { applyPackageManualOverride } from \"./applyPackageManualOverride.js\"\n\nexport const createFindNodeModulePackage = () => {\n  const readPackageFileMemoized = memoizeAsyncFunctionByUrl(\n    (packageFileUrl) => {\n      return readPackageFile(packageFileUrl)\n    },\n  )\n\n  return ({\n    projectDirectoryUrl,\n    packagesManualOverrides = {},\n    packageFileUrl,\n    dependencyName,\n  }) => {\n    const nodeModuleCandidates = getNodeModuleCandidates(\n      packageFileUrl,\n      projectDirectoryUrl,\n    )\n\n    return firstOperationMatching({\n      array: nodeModuleCandidates,\n      start: async (nodeModuleCandidate) => {\n        const packageFileUrlCandidate = `${projectDirectoryUrl}${nodeModuleCandidate}${dependencyName}/package.json`\n        const packageObjectCandidate = await readPackageFileMemoized(\n          packageFileUrlCandidate,\n        )\n\n        return {\n          packageFileUrl: packageFileUrlCandidate,\n          packageJsonObject: applyPackageManualOverride(\n            packageObjectCandidate,\n            packagesManualOverrides,\n          ),\n          syntaxError: packageObjectCandidate === PACKAGE_WITH_SYNTAX_ERROR,\n        }\n      },\n      predicate: ({ packageJsonObject }) => {\n        return packageJsonObject !== PACKAGE_NOT_FOUND\n      },\n    })\n  }\n}\n\nconst getNodeModuleCandidates = (fileUrl, projectDirectoryUrl) => {\n  const fileDirectoryUrl = resolveUrl(\"./\", fileUrl)\n\n  if (fileDirectoryUrl === projectDirectoryUrl) {\n    return [`node_modules/`]\n  }\n\n  const fileDirectoryRelativeUrl = urlToRelativeUrl(\n    fileDirectoryUrl,\n    projectDirectoryUrl,\n  )\n  const candidates = []\n  const relativeNodeModuleDirectoryArray =\n    fileDirectoryRelativeUrl.split(\"node_modules/\")\n  // remove the first empty string\n  relativeNodeModuleDirectoryArray.shift()\n\n  let i = relativeNodeModuleDirectoryArray.length\n  while (i--) {\n    candidates.push(\n      `node_modules/${relativeNodeModuleDirectoryArray\n        .slice(0, i + 1)\n        .join(\"node_modules/\")}node_modules/`,\n    )\n  }\n\n  return [...candidates, \"node_modules/\"]\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport {\n  resolveUrl,\n  readFile,\n  urlToRelativeUrl,\n  urlToFileSystemPath,\n} from \"@jsenv/filesystem\"\n\nimport { createPackageNameMustBeAStringWarning } from \"../logs.js\"\n\nimport { resolvePackageMain } from \"./resolvePackageMain.js\"\nimport { visitPackageImportMap } from \"./visitPackageImportMap.js\"\nimport { visitPackageImports } from \"./visitPackageImports.js\"\nimport { visitPackageExports } from \"./visitPackageExports.js\"\nimport { createFindNodeModulePackage } from \"./node-module-resolution.js\"\n\nexport const visitNodeModuleResolution = async ({\n  // nothing is actually listening for this cancellationToken for now\n  // it's not very important but it would be better to register on it\n  // an stops what we are doing if asked to do so\n  // cancellationToken = createCancellationTokenForProcess(),\n  logger,\n  warn,\n  projectDirectoryUrl,\n  visitors,\n  packagesManualOverrides,\n}) => {\n  const projectPackageFileUrl = resolveUrl(\n    \"./package.json\",\n    projectDirectoryUrl,\n  )\n  const findNodeModulePackage = createFindNodeModulePackage()\n\n  const seen = {}\n  const markPackageAsSeen = (packageFileUrl, importerPackageFileUrl) => {\n    if (packageFileUrl in seen) {\n      seen[packageFileUrl].push(importerPackageFileUrl)\n    } else {\n      seen[packageFileUrl] = [importerPackageFileUrl]\n    }\n  }\n  const packageIsSeen = (packageFileUrl, importerPackageFileUrl) => {\n    return (\n      packageFileUrl in seen &&\n      seen[packageFileUrl].includes(importerPackageFileUrl)\n    )\n  }\n\n  const visit = async ({\n    packageVisitors,\n    packageInfo,\n    packageImporterInfo,\n  }) => {\n    const packageName = packageInfo.object.name\n    if (typeof packageName !== \"string\") {\n      warn(\n        createPackageNameMustBeAStringWarning({\n          packageName,\n          packageInfo,\n        }),\n      )\n      // if package is root, we don't go further\n      // otherwise package name is deduced from file structure\n      // si it's thoerically safe to keep going\n      // in practice it should never happen because npm won't let\n      // a package without name be published\n      if (!packageImporterInfo) {\n        return\n      }\n    }\n\n    packageVisitors = packageVisitors.filter((visitor) => {\n      return (\n        !visitor.packageIncludedPredicate ||\n        visitor.packageIncludedPredicate(packageInfo, packageImporterInfo)\n      )\n    })\n    if (packageVisitors.length === 0) {\n      return\n    }\n\n    await visitDependencies({\n      packageVisitors,\n      packageInfo,\n    })\n\n    await visitPackage({\n      packageVisitors,\n      packageInfo,\n      packageImporterInfo,\n    })\n  }\n\n  const visitDependencies = async ({ packageVisitors, packageInfo }) => {\n    const dependencyMap = packageDependenciesFromPackageObject(\n      packageInfo.object,\n    )\n\n    await Promise.all(\n      Object.keys(dependencyMap).map(async (dependencyName) => {\n        const dependencyInfo = dependencyMap[dependencyName]\n        if (dependencyInfo.type === \"devDependency\") {\n          if (packageInfo.url !== projectPackageFileUrl) {\n            return\n          }\n          const visitorsForDevDependencies = packageVisitors.filter(\n            (visitor) => {\n              return visitor.mappingsForDevDependencies\n            },\n          )\n          if (visitorsForDevDependencies.length === 0) {\n            return\n          }\n\n          await visitDependency({\n            packageVisitors: visitorsForDevDependencies,\n            packageInfo,\n            dependencyName,\n            dependencyInfo,\n          })\n          return\n        }\n\n        await visitDependency({\n          packageVisitors,\n          packageInfo,\n          dependencyName,\n          dependencyInfo,\n        })\n      }),\n    )\n  }\n\n  const visitDependency = async ({\n    packageVisitors,\n    packageInfo,\n    dependencyName,\n    dependencyInfo,\n  }) => {\n    const dependencyData = await findDependency({\n      packageFileUrl: packageInfo.url,\n      dependencyName,\n    })\n    if (!dependencyData) {\n      const cannotFindPackageWarning = createCannotFindPackageWarning({\n        dependencyName,\n        dependencyInfo,\n        packageInfo,\n      })\n      if (dependencyInfo.isOptional) {\n        logger.debug(cannotFindPackageWarning.message)\n      } else {\n        warn(cannotFindPackageWarning)\n      }\n      return\n    }\n    if (dependencyData.syntaxError) {\n      return\n    }\n\n    const {\n      packageFileUrl: dependencyPackageFileUrl,\n      packageJsonObject: dependencyPackageJsonObject,\n    } = dependencyData\n\n    if (packageIsSeen(dependencyPackageFileUrl, packageInfo.url)) {\n      return\n    }\n    markPackageAsSeen(dependencyPackageFileUrl, packageInfo.url)\n    await visit({\n      packageVisitors,\n      packageInfo: {\n        url: dependencyPackageFileUrl,\n        name: dependencyName,\n        object: dependencyPackageJsonObject,\n      },\n      packageImporterInfo: packageInfo,\n    })\n  }\n\n  const visitPackage = async ({\n    packageVisitors,\n    packageInfo,\n    packageImporterInfo,\n  }) => {\n    const packageDerivedInfo = computePackageDerivedInfo({\n      projectDirectoryUrl,\n      packageInfo,\n      packageImporterInfo,\n    })\n\n    const addImportMapForPackage = (visitor, importMap) => {\n      if (packageDerivedInfo.packageIsRoot) {\n        const { imports = {}, scopes = {} } = importMap\n        Object.keys(imports).forEach((from) => {\n          triggerVisitorOnMapping(visitor, {\n            from,\n            to: imports[from],\n          })\n        })\n        Object.keys(scopes).forEach((scope) => {\n          const scopeMappings = scopes[scope]\n          Object.keys(scopeMappings).forEach((key) => {\n            triggerVisitorOnMapping(visitor, {\n              scope,\n              from: key,\n              to: scopeMappings[key],\n            })\n          })\n        })\n        return\n      }\n\n      const { imports = {}, scopes = {} } = importMap\n      const scope = `./${packageDerivedInfo.packageDirectoryRelativeUrl}`\n      Object.keys(imports).forEach((from) => {\n        const to = imports[from]\n        const toMoved = moveMappingValue(\n          to,\n          packageInfo.url,\n          projectDirectoryUrl,\n        )\n        triggerVisitorOnMapping(visitor, {\n          scope,\n          from,\n          to: toMoved,\n        })\n      })\n      Object.keys(scopes).forEach((scope) => {\n        const scopeMappings = scopes[scope]\n        const scopeMoved = moveMappingValue(\n          scope,\n          packageInfo.url,\n          projectDirectoryUrl,\n        )\n        Object.keys(scopeMappings).forEach((key) => {\n          const to = scopeMappings[key]\n          const toMoved = moveMappingValue(\n            to,\n            packageInfo.url,\n            projectDirectoryUrl,\n          )\n          triggerVisitorOnMapping(visitor, {\n            scope: scopeMoved,\n            from: key,\n            to: toMoved,\n          })\n        })\n      })\n    }\n\n    const addMappingsForPackageAndImporter = (visitor, mappings) => {\n      if (packageDerivedInfo.packageIsRoot) {\n        Object.keys(mappings).forEach((from) => {\n          const to = mappings[from]\n          triggerVisitorOnMapping(visitor, {\n            from,\n            to,\n          })\n        })\n        return\n      }\n\n      if (packageDerivedInfo.importerIsRoot) {\n        // own package mappings available to himself\n        Object.keys(mappings).forEach((from) => {\n          const to = mappings[from]\n          triggerVisitorOnMapping(visitor, {\n            scope: `./${packageDerivedInfo.packageDirectoryRelativeUrl}`,\n            from,\n            to,\n          })\n          triggerVisitorOnMapping(visitor, { from, to })\n        })\n\n        // if importer is root no need to make package mappings available to the importer\n        // because they are already on top level mappings\n        return\n      }\n\n      Object.keys(mappings).forEach((from) => {\n        const to = mappings[from]\n        // own package exports available to himself\n        triggerVisitorOnMapping(visitor, {\n          scope: `./${packageDerivedInfo.packageDirectoryRelativeUrl}`,\n          from,\n          to,\n        })\n        // now make package exports available to the importer\n        // here if the importer is himself we could do stuff\n        // we should even handle the case earlier to prevent top level remapping\n        triggerVisitorOnMapping(visitor, {\n          scope: `./${packageDerivedInfo.importerRelativeUrl}`,\n          from,\n          to,\n        })\n      })\n    }\n\n    const importsFromPackageField = await visitPackageImportMap({\n      warn,\n      packageInfo,\n      projectDirectoryUrl,\n    })\n    packageVisitors.forEach((visitor) => {\n      addImportMapForPackage(visitor, importsFromPackageField)\n    })\n\n    if (\"imports\" in packageInfo.object) {\n      packageVisitors.forEach((visitor) => {\n        const packageImports = visitPackageImports({\n          warn,\n          packageInfo,\n          projectDirectoryUrl,\n          packageConditions: visitor.packageConditions,\n        })\n\n        const mappingsFromPackageImports = {}\n        Object.keys(packageImports).forEach((from) => {\n          const to = packageImports[from]\n          mappingsFromPackageImports[from] = to\n        })\n        addImportMapForPackage(visitor, {\n          imports: mappingsFromPackageImports,\n        })\n      })\n    }\n\n    if (\"exports\" in packageInfo.object) {\n      packageVisitors.forEach((visitor) => {\n        const packageExports = visitPackageExports({\n          projectDirectoryUrl,\n          warn,\n          packageInfo,\n          packageConditions: visitor.packageConditions,\n        })\n        const mappingsFromPackageExports = {}\n        Object.keys(packageExports).forEach((from) => {\n          const to = packageExports[from]\n          if (from.indexOf(\"*\") === -1) {\n            mappingsFromPackageExports[from] = to\n            return\n          }\n\n          if (\n            from.endsWith(\"/*\") &&\n            to.endsWith(\"/*\") &&\n            // ensure ends with '*' AND there is only one '*' occurence\n            to.indexOf(\"*\") === to.length - 1\n          ) {\n            const fromWithouTrailingStar = from.slice(0, -1)\n            const toWithoutTrailingStar = to.slice(0, -1)\n            mappingsFromPackageExports[fromWithouTrailingStar] =\n              toWithoutTrailingStar\n            return\n          }\n\n          logger.debug(\n            createExportsWildcardIgnoredWarning({\n              key: from,\n              value: to,\n              packageInfo,\n            }),\n          )\n        })\n        addMappingsForPackageAndImporter(visitor, mappingsFromPackageExports)\n      })\n    } else {\n      // no \"exports\" field means any file can be imported\n      // -> generate a mapping to allow this\n      // https://nodejs.org/docs/latest-v15.x/api/packages.html#packages_name\n      const packageDirectoryRelativeUrl = urlToRelativeUrl(\n        resolveUrl(\"./\", packageInfo.url),\n        projectDirectoryUrl,\n      )\n      packageVisitors.forEach((visitor) => {\n        addMappingsForPackageAndImporter(visitor, {\n          [`${packageInfo.name}/`]: `./${packageDirectoryRelativeUrl}`,\n        })\n      })\n\n      // visit \"main\" only if there is no \"exports\"\n      // https://nodejs.org/docs/latest-v16.x/api/packages.html#packages_main\n      await visitPackageMain({\n        packageVisitors,\n        packageInfo,\n        packageDerivedInfo,\n      })\n    }\n  }\n\n  const visitPackageMain = async ({\n    packageVisitors,\n    packageInfo,\n    packageDerivedInfo,\n  }) => {\n    const {\n      packageIsRoot,\n      importerIsRoot,\n      importerRelativeUrl,\n      packageDirectoryUrl,\n      packageDirectoryUrlExpected,\n    } = packageDerivedInfo\n\n    await packageVisitors.reduce(async (previous, visitor) => {\n      await previous\n      const mainResolutionInfo = await resolvePackageMain({\n        packageInfo,\n      })\n\n      if (!mainResolutionInfo.found) {\n        const { warning } = mainResolutionInfo\n        // main explicitely disabled\n        if (packageInfo.object.main === \"\") {\n          return\n        }\n\n        // main \"should\" be there but if we warn there is many false positive\n        // when package have no main file and that's expected\n        if (packageInfo.object.main === undefined) {\n          logger.debug(warning.message)\n        } else {\n          // we don't know yet if the codebase will rely on main file presence or not\n          // so when main does not lead to a file:\n          // - a warning is logged\n          // - we still generate the mapping\n          warn(warning)\n        }\n      }\n\n      const mainFileRelativeUrl = urlToRelativeUrl(\n        resolveUrl(mainResolutionInfo.relativeUrl, packageInfo.url),\n        projectDirectoryUrl,\n      )\n      const scope =\n        packageIsRoot || importerIsRoot ? null : `./${importerRelativeUrl}`\n      const from = packageInfo.name\n      const to = `./${mainFileRelativeUrl}`\n\n      triggerVisitorOnMapping(visitor, {\n        scope,\n        from,\n        to,\n      })\n\n      if (packageDirectoryUrl !== packageDirectoryUrlExpected) {\n        triggerVisitorOnMapping(visitor, {\n          scope: `./${importerRelativeUrl}`,\n          from,\n          to,\n        })\n      }\n    }, Promise.resolve())\n  }\n\n  const dependenciesCache = {}\n  const findDependency = ({ packageFileUrl, dependencyName }) => {\n    if (packageFileUrl in dependenciesCache === false) {\n      dependenciesCache[packageFileUrl] = {}\n    }\n    if (dependencyName in dependenciesCache[packageFileUrl]) {\n      return dependenciesCache[packageFileUrl][dependencyName]\n    }\n    const dependencyPromise = findNodeModulePackage({\n      projectDirectoryUrl,\n      packageFileUrl,\n      dependencyName,\n      packagesManualOverrides,\n    })\n    dependenciesCache[packageFileUrl][dependencyName] = dependencyPromise\n    return dependencyPromise\n  }\n\n  let projectPackageObject\n  try {\n    projectPackageObject = await readFile(projectPackageFileUrl, { as: \"json\" })\n  } catch (e) {\n    if (e.code === \"ENOENT\") {\n      const error = new Error(\n        createDetailedMessage(`Cannot find project package.json file.`, {\n          \"package.json url\": projectPackageFileUrl,\n        }),\n      )\n      error.code = \"PROJECT_PACKAGE_FILE_NOT_FOUND\"\n      throw error\n    }\n    throw e\n  }\n\n  const importerPackageFileUrl = projectPackageFileUrl\n  markPackageAsSeen(projectPackageFileUrl, importerPackageFileUrl)\n  await visit({\n    packageInfo: {\n      url: projectPackageFileUrl,\n      name: projectPackageObject.name,\n      object: projectPackageObject,\n    },\n    packageImporterInfo: null,\n    packageVisitors: visitors,\n  })\n}\n\nconst triggerVisitorOnMapping = (visitor, { scope, from, to }) => {\n  if (scope) {\n    // when a package says './' maps to './'\n    // we add something to say if we are already inside the package\n    // no need to ensure leading slash are scoped to the package\n    if (from === \"./\" && to === scope) {\n      triggerVisitorOnMapping(visitor, {\n        scope,\n        from: scope,\n        to: scope,\n      })\n      const packageName = scope.slice(\n        scope.lastIndexOf(\"node_modules/\") + `node_modules/`.length,\n      )\n      triggerVisitorOnMapping(visitor, {\n        scope,\n        from: packageName,\n        to: scope,\n      })\n    }\n\n    visitor.onMapping({\n      scope,\n      from,\n      to,\n    })\n    return\n  }\n\n  // we could think it's useless to remap from with to\n  // however it can be used to ensure a weaker remapping\n  // does not win over this specific file or folder\n  if (from === to) {\n    /**\n     * however remapping '/' to '/' is truly useless\n     * moreover it would make wrapImportMap create something like\n     * {\n     *   imports: {\n     *     \"/\": \"/.dist/best/\"\n     *   }\n     * }\n     * that would append the wrapped folder twice\n     * */\n    if (from === \"/\") return\n  }\n  visitor.onMapping({ from, to })\n}\n\nconst packageDependenciesFromPackageObject = (packageObject) => {\n  const packageDependencies = {}\n\n  const { dependencies = {} } = packageObject\n  // https://npm.github.io/using-pkgs-docs/package-json/types/optionaldependencies.html\n  const { optionalDependencies = {} } = packageObject\n  Object.keys(dependencies).forEach((dependencyName) => {\n    packageDependencies[dependencyName] = {\n      type: \"dependency\",\n      isOptional: dependencyName in optionalDependencies,\n      versionPattern: dependencies[dependencyName],\n    }\n  })\n\n  const { peerDependencies = {} } = packageObject\n  const { peerDependenciesMeta = {} } = packageObject\n  Object.keys(peerDependencies).forEach((dependencyName) => {\n    packageDependencies[dependencyName] = {\n      type: \"peerDependency\",\n      versionPattern: peerDependencies[dependencyName],\n      isOptional:\n        dependencyName in peerDependenciesMeta &&\n        peerDependenciesMeta[dependencyName].optional,\n    }\n  })\n\n  const { devDependencies = {} } = packageObject\n  Object.keys(devDependencies).forEach((dependencyName) => {\n    if (!packageDependencies.hasOwnProperty(dependencyName)) {\n      packageDependencies[dependencyName] = {\n        type: \"devDependency\",\n        versionPattern: devDependencies[dependencyName],\n      }\n    }\n  })\n\n  return packageDependencies\n}\n\nconst moveMappingValue = (address, from, to) => {\n  const url = resolveUrl(address, from)\n  const relativeUrl = urlToRelativeUrl(url, to)\n  if (relativeUrl.startsWith(\"../\")) {\n    return relativeUrl\n  }\n  if (relativeUrl.startsWith(\"./\")) {\n    return relativeUrl\n  }\n  if (/^[a-zA-Z]{2,}:/.test(relativeUrl)) {\n    // has sheme\n    return relativeUrl\n  }\n  return `./${relativeUrl}`\n}\n\nconst computePackageDerivedInfo = ({\n  projectDirectoryUrl,\n  packageInfo,\n  packageImporterInfo,\n}) => {\n  if (!packageImporterInfo) {\n    const packageDirectoryUrl = resolveUrl(\"./\", packageInfo.url)\n    urlToRelativeUrl(packageDirectoryUrl, projectDirectoryUrl)\n\n    return {\n      importerIsRoot: false,\n      importerRelativeUrl: \"\",\n      packageIsRoot: true,\n      packageDirectoryUrl,\n      packageDirectoryUrlExpected: packageDirectoryUrl,\n      packageDirectoryRelativeUrl: urlToRelativeUrl(\n        packageDirectoryUrl,\n        projectDirectoryUrl,\n      ),\n    }\n  }\n\n  const projectPackageFileUrl = resolveUrl(\n    \"./package.json\",\n    projectDirectoryUrl,\n  )\n\n  const importerIsRoot = packageImporterInfo.url === projectPackageFileUrl\n\n  const importerPackageDirectoryUrl = resolveUrl(\"./\", packageImporterInfo.url)\n\n  const importerRelativeUrl = urlToRelativeUrl(\n    importerPackageDirectoryUrl,\n    projectDirectoryUrl,\n  )\n\n  const packageIsRoot = packageInfo.url === projectPackageFileUrl\n\n  const packageDirectoryUrl = resolveUrl(\"./\", packageInfo.url)\n\n  const packageDirectoryUrlExpected = `${importerPackageDirectoryUrl}node_modules/${packageInfo.name}/`\n\n  const packageDirectoryRelativeUrl = urlToRelativeUrl(\n    packageDirectoryUrl,\n    projectDirectoryUrl,\n  )\n\n  return {\n    importerIsRoot,\n    importerRelativeUrl,\n    packageIsRoot,\n    packageDirectoryUrl,\n    packageDirectoryUrlExpected,\n    packageDirectoryRelativeUrl,\n  }\n}\n\nconst createExportsWildcardIgnoredWarning = ({ key, value, packageInfo }) => {\n  return {\n    code: \"EXPORTS_WILDCARD\",\n    message: `Ignoring export using \"*\" because it is not supported by importmap.\n--- key ---\n${key}\n--- value ---\n${value}\n--- package.json path ---\n${urlToFileSystemPath(packageInfo.url)}\n--- see also ---\nhttps://github.com/WICG/import-maps/issues/232`,\n  }\n}\n\nconst createCannotFindPackageWarning = ({\n  dependencyName,\n  dependencyInfo,\n  packageInfo,\n}) => {\n  const dependencyIsOptional = dependencyInfo.isOptional\n  const dependencyType = dependencyInfo.type\n  const dependencyVersionPattern = dependencyInfo.versionPattern\n  return {\n    code: \"CANNOT_FIND_PACKAGE\",\n    message: createDetailedMessage(\n      dependencyIsOptional\n        ? `cannot find an optional ${dependencyType}.`\n        : `cannot find a ${dependencyType}.`,\n      {\n        [dependencyType]: `${dependencyName}@${dependencyVersionPattern}`,\n        \"required by\": urlToFileSystemPath(packageInfo.url),\n      },\n    ),\n  }\n}\n",
    "export const optimizeImportMap = ({ imports, scopes }) => {\n  // remove useless duplicates (scoped key+value already defined on imports)\n  const scopesOptimized = {}\n  Object.keys(scopes).forEach((scope) => {\n    const scopeMappings = scopes[scope]\n    const scopeMappingsOptimized = {}\n    Object.keys(scopeMappings).forEach((mappingKey) => {\n      const topLevelMappingValue = imports[mappingKey]\n      const mappingValue = scopeMappings[mappingKey]\n      if (!topLevelMappingValue || topLevelMappingValue !== mappingValue) {\n        scopeMappingsOptimized[mappingKey] = mappingValue\n      }\n    })\n    if (Object.keys(scopeMappingsOptimized).length > 0) {\n      scopesOptimized[scope] = scopeMappingsOptimized\n    }\n  })\n  return { imports, scopes: scopesOptimized }\n}\n",
    "import { createDetailedMessage } from \"@jsenv/logger\"\nimport {\n  resolveUrl,\n  readFile,\n  readFileSystemNodeStat,\n  urlToRelativeUrl,\n} from \"@jsenv/filesystem\"\n\nimport { createPackageNameMustBeAStringWarning } from \"../logs.js\"\nimport { packageConditionsFromPackageUserConditions } from \"../package_conditions.js\"\nimport { visitPackageExports } from \"../from-package/visitPackageExports.js\"\nimport { resolvePackageMain } from \"../from-package/resolvePackageMain.js\"\n\nconst entryPointResolutionFailureMessage = `Cannot find project entry point`\n\nexport const resolveProjectEntryPoint = async ({\n  projectDirectoryUrl,\n  warn,\n  packageUserConditions,\n  runtime,\n}) => {\n  const packageConditions = packageConditionsFromPackageUserConditions({\n    runtime,\n    packageUserConditions,\n  })\n\n  const projectPackageFileUrl = resolveUrl(\n    \"./package.json\",\n    projectDirectoryUrl,\n  )\n  const projectPackageObject = await readFile(projectPackageFileUrl, {\n    as: \"json\",\n  })\n  const projectPackageName = projectPackageObject.name\n  if (typeof projectPackageName !== \"string\") {\n    warn(\n      createPackageNameMustBeAStringWarning({\n        packageName: projectPackageName,\n        packageFileUrl: projectPackageFileUrl,\n      }),\n    )\n    return null\n  }\n\n  const projectPackageInfo = {\n    name: projectPackageName,\n    url: projectPackageFileUrl,\n    object: projectPackageObject,\n  }\n\n  if (\"exports\" in projectPackageObject) {\n    const packageExports = projectPackageObject.exports\n\n    if (packageExports === false || packageExports === null) {\n      warn({\n        code: \"PROJECT_ENTRY_POINT_RESOLUTION_FAILED\",\n        message: createDetailedMessage(entryPointResolutionFailureMessage, {\n          reason: `explicitely disabled in package.json (\"exports\" is ${packageExports})`,\n        }),\n      })\n      return null\n    }\n\n    if (typeof packageExports === \"string\") {\n      return tryExportSubpath({\n        warn,\n        exportSubpath: packageExports,\n        projectPackageFileUrl,\n      })\n    }\n\n    const packageSubpaths = visitPackageExports({\n      projectDirectoryUrl,\n      warn,\n      packageInfo: projectPackageInfo,\n      packageExports,\n      packageConditions,\n    })\n    const subpathKey = Object.keys(packageSubpaths).find(\n      (from) => from === projectPackageName,\n    )\n    if (!subpathKey) {\n      warn({\n        code: \"PROJECT_ENTRY_POINT_RESOLUTION_FAILED\",\n        message: createDetailedMessage(entryPointResolutionFailureMessage, {\n          reason: `no subpath found in package.json \"exports\"`,\n        }),\n      })\n      return null\n    }\n    return tryExportSubpath({\n      warn,\n      exportSubpath: packageSubpaths[subpathKey],\n      projectPackageFileUrl,\n    })\n  }\n\n  // visit \"main\" only if there is no \"exports\"\n  // https://nodejs.org/docs/latest-v16.x/api/packages.html#packages_main\n  const main = projectPackageObject.main\n  if (main === \"\") {\n    warn({\n      code: \"PROJECT_ENTRY_POINT_RESOLUTION_FAILED\",\n      message: createDetailedMessage(entryPointResolutionFailureMessage, {\n        reason: `explicitely disabled in package.json (\"main\" is an empty string)`,\n      }),\n    })\n    return null\n  }\n\n  const packageMainResolutionInfo = await resolvePackageMain({\n    warn,\n    packageInfo: projectPackageInfo,\n  })\n  if (!packageMainResolutionInfo.found) {\n    warn({\n      code: \"PROJECT_ENTRY_POINT_RESOLUTION_FAILED\",\n      message: createDetailedMessage(entryPointResolutionFailureMessage, {\n        reason: packageMainResolutionInfo.warning.message,\n      }),\n    })\n    return null\n  }\n\n  return packageMainResolutionInfo.relativeUrl\n}\n\nconst tryExportSubpath = async ({\n  warn,\n  exportSubpath,\n  projectPackageFileUrl,\n}) => {\n  const subpathUrl = resolveUrl(exportSubpath, projectPackageFileUrl)\n  const filesystemStat = await readFileSystemNodeStat(subpathUrl, {\n    nullIfNotFound: true,\n  })\n  if (filesystemStat === null || !filesystemStat.isFile()) {\n    warn({\n      code: \"PROJECT_ENTRY_POINT_RESOLUTION_FAILED\",\n      message: createDetailedMessage(entryPointResolutionFailureMessage, {\n        reason: `file not found for \"${exportSubpath}\" declared in package.json \"exports\"`,\n      }),\n    })\n    return null\n  }\n  return urlToRelativeUrl(subpathUrl, projectPackageFileUrl)\n}\n",
    "/* global __filename */\n\nconst filenameContainsBackSlashes = __filename.indexOf(\"\\\\\") > -1\n\nconst url = filenameContainsBackSlashes\n  ? `file:///${__filename.replace(/\\\\/g, \"/\")}`\n  : `file://${__filename}`\n\nexport default url\n",
    "import { createRequire } from \"node:module\"\nimport { parseAsync } from \"@babel/core\"\nimport { urlToFileSystemPath } from \"@jsenv/filesystem\"\n\nconst require = createRequire(import.meta.url)\n\nconst traverse = require(\"@babel/traverse\")\n\nexport const parseImportSpecifiers = async (\n  url,\n  { urlResponseText, babelOptions } = {},\n) => {\n  const ast = await parseAsync(urlResponseText, {\n    ...babelOptions,\n    sourceType: \"module\",\n    filename: url.startsWith(\"file://\") ? urlToFileSystemPath(url) : url,\n    plugins: babelOptions.plugins,\n    // ranges: true,\n    parserOpts: {\n      ranges: true,\n    },\n  })\n\n  const specifiers = {}\n\n  const addSpecifier = ({ path, type }) => {\n    const specifier = path.node.value\n    specifiers[specifier] = {\n      line: path.node.loc.start.line,\n      column: path.node.loc.start.column,\n      type,\n    }\n  }\n\n  traverse.default(ast, {\n    // \"ImportExpression is replaced with a CallExpression whose callee is an Import node.\"\n    // https://babeljs.io/docs/en/babel-parser#output\n    // ImportExpression: (path) => {\n    //   if (path.node.arguments[0].type !== \"StringLiteral\") {\n    //     // Non-string argument, probably a variable or expression, e.g.\n    //     // import(moduleId)\n    //     // import('./' + moduleName)\n    //     return\n    //   }\n    //   addSpecifier(path.get(\"arguments\")[0])\n    // },\n    CallExpression: (path) => {\n      if (path.node.callee.type !== \"Import\") {\n        // Some other function call, not import();\n        return\n      }\n      if (path.node.arguments[0].type !== \"StringLiteral\") {\n        // Non-string argument, probably a variable or expression, e.g.\n        // import(moduleId)\n        // import('./' + moduleName)\n        return\n      }\n      addSpecifier({\n        path: path.get(\"arguments\")[0],\n        type: \"import-dynamic\",\n      })\n    },\n    ExportAllDeclaration: (path) => {\n      addSpecifier({\n        path: path.get(\"source\"),\n        type: \"export-all\",\n      })\n    },\n    ExportNamedDeclaration: (path) => {\n      if (!path.node.source) {\n        // This export has no \"source\", so it's probably\n        // a local variable or function, e.g.\n        // export { varName }\n        // export const constName = ...\n        // export function funcName() {}\n        return\n      }\n      addSpecifier({\n        path: path.get(\"source\"),\n        type: \"export-named\",\n      })\n    },\n    ImportDeclaration: (path) => {\n      addSpecifier({\n        path: path.get(\"source\"),\n        type: \"import-static\",\n      })\n    },\n  })\n\n  return specifiers\n}\n",
    "// https://github.com/postcss/postcss/blob/fd30d3df5abc0954a0ec642a3cdc644ab2aacf9c/lib/css-syntax-error.js#L43\n// https://github.com/postcss/postcss/blob/fd30d3df5abc0954a0ec642a3cdc644ab2aacf9c/lib/terminal-highlight.js#L50\n// https://github.com/babel/babel/blob/eea156b2cb8deecfcf82d52aa1b71ba4995c7d68/packages/babel-code-frame/src/index.js#L1\n\nexport const showSource = ({ url, line, column, source }) => {\n  let message = \"\"\n\n  message += typeof url === \"undefined\" ? \"Anonymous\" : url\n  if (typeof line !== \"number\") {\n    return message\n  }\n\n  message += `:${line}`\n  if (typeof column === \"number\") {\n    message += `:${column}`\n  }\n\n  if (!source) {\n    return message\n  }\n\n  return `${message}\n${showSourceLocation(source, {\n  line,\n  column,\n})}`\n}\n\nconst red = \"\\x1b[31m\"\nconst grey = \"\\x1b[39m\"\nconst ansiResetSequence = \"\\x1b[0m\"\n\nconst showSourceLocation = (\n  source,\n  {\n    line,\n    column,\n    numberOfSurroundingLinesToShow = 1,\n    lineMaxLength = 120,\n    color = false,\n    markColor = red,\n    asideColor = grey,\n    colorMark = (string) => `${markColor}${string}${ansiResetSequence}`,\n    colorAside = (string) => `${asideColor}${string}${ansiResetSequence}`,\n  },\n) => {\n  const mark = color ? colorMark : (string) => string\n  const aside = color ? colorAside : (string) => string\n\n  const lines = source.split(/\\r?\\n/)\n  let lineRange = {\n    start: line - 1,\n    end: line,\n  }\n  lineRange = moveLineRangeUp(lineRange, numberOfSurroundingLinesToShow)\n  lineRange = moveLineRangeDown(lineRange, numberOfSurroundingLinesToShow)\n  lineRange = lineRangeWithinLines(lineRange, lines)\n  const linesToShow = lines.slice(lineRange.start, lineRange.end)\n  const endLineNumber = lineRange.end\n  const lineNumberMaxWidth = String(endLineNumber).length\n\n  const columnRange = {}\n  if (column === undefined) {\n    columnRange.start = 0\n    columnRange.end = lineMaxLength\n  } else if (column > lineMaxLength) {\n    columnRange.start = column - Math.floor(lineMaxLength / 2)\n    columnRange.end = column + Math.ceil(lineMaxLength / 2)\n  } else {\n    columnRange.start = 0\n    columnRange.end = lineMaxLength\n  }\n\n  return linesToShow.map((lineSource, index) => {\n    const lineNumber = lineRange.start + index + 1\n    const isMainLine = lineNumber === line\n    const lineSourceTruncated = applyColumnRange(columnRange, lineSource)\n    const lineNumberWidth = String(lineNumber).length\n    // ensure if line moves from 7,8,9 to 10 the display is still great\n    const lineNumberRightSpacing = \" \".repeat(\n      lineNumberMaxWidth - lineNumberWidth,\n    )\n    const asideSource = `${lineNumber}${lineNumberRightSpacing} |`\n    const lineFormatted = `${aside(asideSource)} ${lineSourceTruncated}`\n    if (isMainLine) {\n      if (column === undefined) {\n        return `${mark(\">\")} ${lineFormatted}`\n      }\n      const lineSourceUntilColumn = lineSourceTruncated.slice(\n        0,\n        column - columnRange.start,\n      )\n      const spacing = stringToSpaces(lineSourceUntilColumn)\n      const mainLineFormatted = `${mark(\">\")} ${lineFormatted}\n  ${\" \".repeat(lineNumberWidth)} ${aside(\"|\")}${spacing}${mark(\"^\")}`\n      return mainLineFormatted\n    }\n    return `  ${lineFormatted}`\n  }).join(`\n`)\n}\n\nconst applyColumnRange = ({ start, end }, line) => {\n  if (typeof start !== \"number\") {\n    throw new TypeError(`start must be a number, received ${start}`)\n  }\n  if (typeof end !== \"number\") {\n    throw new TypeError(`end must be a number, received ${end}`)\n  }\n  if (end < start) {\n    throw new Error(\n      `end must be greater than start, but ${end} is smaller than ${start}`,\n    )\n  }\n\n  const prefix = \"…\"\n  const suffix = \"…\"\n  const lastIndex = line.length\n\n  if (line.length === 0) {\n    // don't show any ellipsis if the line is empty\n    // because it's not truncated in that case\n    return \"\"\n  }\n\n  const startTruncated = start > 0\n  const endTruncated = lastIndex > end\n\n  let from = startTruncated ? start + prefix.length : start\n  let to = endTruncated ? end - suffix.length : end\n  if (to > lastIndex) to = lastIndex\n\n  if (start >= lastIndex || from === to) {\n    return \"\"\n  }\n\n  let result = \"\"\n  while (from < to) {\n    result += line[from]\n    from++\n  }\n\n  if (result.length === 0) {\n    return \"\"\n  }\n  if (startTruncated && endTruncated) {\n    return `${prefix}${result}${suffix}`\n  }\n  if (startTruncated) {\n    return `${prefix}${result}`\n  }\n  if (endTruncated) {\n    return `${result}${suffix}`\n  }\n  return result\n}\n\nconst stringToSpaces = (string) => string.replace(/[^\\t]/g, \" \")\n\n// const getLineRangeLength = ({ start, end }) => end - start\n\nconst moveLineRangeUp = ({ start, end }, number) => {\n  return {\n    start: start - number,\n    end,\n  }\n}\n\nconst moveLineRangeDown = ({ start, end }, number) => {\n  return {\n    start,\n    end: end + number,\n  }\n}\n\nconst lineRangeWithinLines = ({ start, end }, lines) => {\n  return {\n    start: start < 0 ? 0 : start,\n    end: end > lines.length ? lines.length : end,\n  }\n}\n",
    "import { loadOptionsAsync } from \"@babel/core\"\n\nimport {\n  resolveUrl,\n  readFile,\n  urlToExtension,\n  urlToRelativeUrl,\n  urlIsInsideOf,\n  urlToFileSystemPath,\n} from \"@jsenv/filesystem\"\nimport {\n  normalizeImportMap,\n  resolveImport,\n  composeTwoImportMaps,\n} from \"@jsenv/importmap\"\nimport { isSpecifierForNodeCoreModule } from \"@jsenv/importmap/src/isSpecifierForNodeCoreModule.js\"\n\nimport {\n  memoizeAsyncFunctionByUrl,\n  memoizeAsyncFunctionBySpecifierAndImporter,\n} from \"../memoizeAsyncFunction.js\"\n\nimport { parseImportSpecifiers } from \"./parseImportSpecifiers.js\"\nimport { showSource } from \"./showSource.js\"\nimport { resolveFile } from \"../resolveFile.js\"\nimport {\n  createBareSpecifierAutomappingMessage,\n  createExtensionLessAutomappingMessage,\n  createImportResolutionFailedWarning,\n} from \"../logs.js\"\n\nexport const visitSourceFiles = async ({\n  logger,\n  warn,\n  projectDirectoryUrl,\n  projectEntryPoint,\n  runtime,\n  importMap,\n  bareSpecifierAutomapping,\n  extensionlessAutomapping,\n  magicExtensions, //  = [\".js\", \".jsx\", \".ts\", \".tsx\", \".node\", \".json\"],\n  removeUnusedMappings,\n}) => {\n  const imports = {}\n  const scopes = {}\n  const addMapping = ({ scope, from, to }) => {\n    if (scope) {\n      scopes[scope] = {\n        ...(scopes[scope] || {}),\n        [from]: to,\n      }\n    } else {\n      imports[from] = to\n    }\n  }\n\n  const topLevelMappingsUsed = []\n  const scopedMappingsUsed = {}\n  const markMappingAsUsed = ({ scope, from, to }) => {\n    if (scope) {\n      if (scope in scopedMappingsUsed) {\n        scopedMappingsUsed[scope].push({ from, to })\n      } else {\n        scopedMappingsUsed[scope] = [{ from, to }]\n      }\n    } else {\n      topLevelMappingsUsed.push({ from, to })\n    }\n  }\n\n  const baseUrl =\n    runtime === \"browser\"\n      ? fileUrlToHttpUrl(projectDirectoryUrl, {\n          projectDirectoryUrl,\n          baseUrl: \"http://jsenv.com\",\n        })\n      : projectDirectoryUrl\n\n  // https://babeljs.io/docs/en/babel-core#loadoptions\n  const babelOptions = await loadOptionsAsync({\n    root: urlToFileSystemPath(projectDirectoryUrl),\n  })\n\n  const importResolver = createImportResolver({\n    logger,\n    warn,\n    runtime,\n    importMap,\n    projectDirectoryUrl,\n    baseUrl,\n    bareSpecifierAutomapping,\n    extensionlessAutomapping,\n    magicExtensions,\n    onImportMapping: ({ scope, from }) => {\n      if (scope) {\n        // make scope relative again\n        scope = `./${urlToRelativeUrl(scope, baseUrl)}`\n        // make from relative again\n        if (from.startsWith(baseUrl)) {\n          from = `./${urlToRelativeUrl(from, baseUrl)}`\n        }\n      }\n\n      markMappingAsUsed({\n        scope,\n        from,\n        to: scope ? importMap.scopes[scope][from] : importMap.imports[from],\n      })\n    },\n    performAutomapping: (automapping) => {\n      addMapping(automapping)\n      markMappingAsUsed(automapping)\n    },\n  })\n\n  const visitUrl = memoizeAsyncFunctionBySpecifierAndImporter(\n    async (specifier, importer, { importedBy }) => {\n      const { found, ignore, url, body } =\n        await importResolver.applyImportResolution({\n          specifier,\n          importer,\n          importedBy,\n        })\n\n      if (!found || ignore) {\n        return\n      }\n\n      if (!visitUrlResponse.isInMemory(url)) {\n        await visitUrlResponse(url, { body })\n      }\n    },\n  )\n\n  const visitUrlResponse = memoizeAsyncFunctionByUrl(async (url, { body }) => {\n    const specifiers = await parseImportSpecifiers(url, {\n      urlResponseText: body,\n      babelOptions,\n    })\n    const fileUrl =\n      httpUrlToFileUrl(url, { projectDirectoryUrl, baseUrl }) || url\n    await Promise.all(\n      Object.keys(specifiers).map(async (specifier) => {\n        const specifierInfo = specifiers[specifier]\n        await visitUrl(specifier, url, {\n          importedBy: showSource({\n            url: fileUrl,\n            line: specifierInfo.line,\n            column: specifierInfo.column,\n            source: body,\n          }),\n        })\n      }),\n    )\n  })\n\n  await visitUrl(`./${projectEntryPoint}`, baseUrl, {\n    importedBy: \"project package.json\",\n  })\n\n  if (removeUnusedMappings) {\n    const importsUsed = {}\n    topLevelMappingsUsed.forEach(({ from, to }) => {\n      importsUsed[from] = to\n    })\n    const scopesUsed = {}\n    Object.keys(scopedMappingsUsed).forEach((scope) => {\n      const mappingsUsed = scopedMappingsUsed[scope]\n      const scopedMappings = {}\n      mappingsUsed.forEach(({ from, to }) => {\n        scopedMappings[from] = to\n      })\n      scopesUsed[scope] = scopedMappings\n    })\n    return {\n      imports: importsUsed,\n      scopes: scopesUsed,\n    }\n  }\n\n  return composeTwoImportMaps(importMap, { imports, scopes })\n}\n\nconst createImportResolver = ({\n  logger,\n  warn,\n  runtime,\n  importMap,\n  baseUrl,\n  projectDirectoryUrl,\n  bareSpecifierAutomapping,\n  extensionlessAutomapping,\n  magicExtensions,\n  onImportMapping,\n  performAutomapping,\n}) => {\n  const importMapNormalized = normalizeImportMap(importMap, baseUrl)\n  const BARE_SPECIFIER_ERROR = {}\n\n  const applyImportResolution = async ({ specifier, importer, importedBy }) => {\n    if (runtime === \"node\" && isSpecifierForNodeCoreModule(specifier)) {\n      return {\n        found: true,\n        ignore: true,\n      }\n    }\n\n    const { gotBareSpecifierError, importUrl } = resolveImportUrl({\n      specifier,\n      importer,\n    })\n\n    const importFileUrl = httpUrlToFileUrl(importUrl, {\n      projectDirectoryUrl,\n      baseUrl,\n    })\n\n    if (importFileUrl) {\n      return handleFileUrl({\n        specifier,\n        importer,\n        importedBy,\n        gotBareSpecifierError,\n        importUrl: importFileUrl,\n      })\n    }\n\n    if (importUrl.startsWith(\"http:\") || importUrl.startsWith(\"https:\")) {\n      return handleHttpUrl()\n    }\n\n    return handleFileUrl({\n      specifier,\n      importer,\n      importedBy,\n      gotBareSpecifierError,\n      importUrl,\n    })\n  }\n\n  const resolveImportUrl = ({ specifier, importer }) => {\n    try {\n      const importUrl = resolveImport({\n        specifier,\n        importer,\n        importMap: importMapNormalized,\n        defaultExtension: false,\n        onImportMapping,\n        createBareSpecifierError: () => BARE_SPECIFIER_ERROR,\n      })\n\n      return {\n        gotBareSpecifierError: false,\n        importUrl,\n      }\n    } catch (e) {\n      return {\n        gotBareSpecifierError: true,\n        importUrl: resolveUrl(specifier, importer),\n      }\n    }\n  }\n\n  const handleHttpUrl = async () => {\n    // NICE TO HAVE: perform an http request and check for 404 and things like that\n    // the day we do the http request, this function would return both\n    // if the file is found and the file content\n    // because once http request is done we can await response body\n    // CURRENT BEHAVIOUR: consider http url as found without checking\n    return {\n      found: true,\n      ignore: true,\n      body: null,\n    }\n  }\n\n  const foundFileUrl = async (url) => {\n    const extension = urlToExtension(url)\n    const isJs = [\".js\", \".jsx\", \".ts\", \".tsx\", \".mjs\", \".cjs\"].includes(\n      extension,\n    )\n    const httpUrl = fileUrlToHttpUrl(url, { projectDirectoryUrl, baseUrl })\n\n    if (isJs) {\n      return {\n        found: true,\n        url: httpUrl || url,\n        body: await readFile(url, { as: \"string\" }),\n      }\n    }\n\n    return {\n      found: true,\n      ignore: true,\n      url: httpUrl || url,\n    }\n  }\n\n  const handleFileUrl = async ({\n    specifier,\n    importer,\n    importedBy,\n    gotBareSpecifierError,\n    importUrl,\n  }) => {\n    const { magicExtension, found, url } = await resolveFile(importUrl, {\n      magicExtensionEnabled: true,\n      magicExtensions: magicExtensionWithImporterExtension(\n        magicExtensions || [],\n        importer,\n      ),\n    })\n    const packageDirectoryUrl = packageDirectoryUrlFromUrl(\n      url,\n      projectDirectoryUrl,\n    )\n    const packageFileUrl = resolveUrl(\"package.json\", packageDirectoryUrl)\n    const scope =\n      packageDirectoryUrl === projectDirectoryUrl\n        ? undefined\n        : `./${urlToRelativeUrl(packageDirectoryUrl, projectDirectoryUrl)}`\n    const automapping = {\n      scope,\n      from: specifier,\n      to: `./${urlToRelativeUrl(url, projectDirectoryUrl)}`,\n    }\n    if (gotBareSpecifierError) {\n      if (!found) {\n        warn(\n          createImportResolutionFailedWarning({\n            specifier,\n            importedBy,\n            gotBareSpecifierError,\n            suggestsNodeRuntime:\n              runtime !== \"node\" && isSpecifierForNodeCoreModule(specifier),\n          }),\n        )\n        return { found: false }\n      }\n      if (!bareSpecifierAutomapping) {\n        warn(\n          createImportResolutionFailedWarning({\n            specifier,\n            importedBy,\n            gotBareSpecifierError,\n            automapping,\n          }),\n        )\n        return { found: false }\n      }\n      logger.debug(\n        createBareSpecifierAutomappingMessage({\n          specifier,\n          importedBy,\n          automapping,\n        }),\n      )\n      performAutomapping(automapping)\n      return foundFileUrl(url)\n    }\n    if (!found) {\n      warn(\n        createImportResolutionFailedWarning({\n          specifier,\n          importedBy,\n        }),\n      )\n      return { found: false }\n    }\n    if (magicExtension) {\n      if (!extensionlessAutomapping) {\n        const mappingFoundInPackageExports =\n          await extensionIsMappedInPackageExports(packageFileUrl)\n        if (!mappingFoundInPackageExports) {\n          warn(\n            createImportResolutionFailedWarning({\n              specifier,\n              importedBy,\n              magicExtension,\n              automapping,\n            }),\n          )\n          return { found: false }\n        }\n        logger.debug(\n          createExtensionLessAutomappingMessage({\n            specifier,\n            importedBy,\n            automapping,\n            mappingFoundInPackageExports,\n          }),\n        )\n        performAutomapping(automapping)\n        return foundFileUrl(url)\n      }\n      logger.debug(\n        createExtensionLessAutomappingMessage({\n          specifier,\n          importedBy,\n          automapping,\n        }),\n      )\n      performAutomapping(automapping)\n      return foundFileUrl(url)\n    }\n    return foundFileUrl(url)\n  }\n\n  return { applyImportResolution }\n}\n\nconst fileUrlToHttpUrl = (url, { projectDirectoryUrl, baseUrl }) =>\n  moveUrl({ url, from: projectDirectoryUrl, to: baseUrl })\n\nconst httpUrlToFileUrl = (url, { projectDirectoryUrl, baseUrl }) =>\n  moveUrl({ url, from: baseUrl, to: projectDirectoryUrl })\n\nconst moveUrl = ({ url, from, to }) => {\n  if (urlIsInsideOf(url, from)) {\n    const relativeUrl = urlToRelativeUrl(url, from)\n    return resolveUrl(relativeUrl, to)\n  }\n  if (url === from) {\n    return to\n  }\n  return null\n}\n\nconst extensionIsMappedInPackageExports = async (packageFileUrl) => {\n  const closestPackageObject = await readFile(packageFileUrl, {\n    as: \"json\",\n  })\n  // it's imprecise because we are not ensuring the wildcard correspond\n  // to the required mapping, but good enough for now\n  const containsWildcard = Object.keys(closestPackageObject.exports || {}).some(\n    (key) => key.includes(\"*\"),\n  )\n  return containsWildcard\n}\n\nconst packageDirectoryUrlFromUrl = (url, projectDirectoryUrl) => {\n  const relativeUrl = urlToRelativeUrl(url, projectDirectoryUrl)\n\n  const lastNodeModulesDirectoryStartIndex =\n    relativeUrl.lastIndexOf(\"node_modules/\")\n  if (lastNodeModulesDirectoryStartIndex === -1) {\n    return projectDirectoryUrl\n  }\n\n  const lastNodeModulesDirectoryEndIndex =\n    lastNodeModulesDirectoryStartIndex + `node_modules/`.length\n\n  const beforeNodeModulesLastDirectory = relativeUrl.slice(\n    0,\n    lastNodeModulesDirectoryEndIndex,\n  )\n  const afterLastNodeModulesDirectory = relativeUrl.slice(\n    lastNodeModulesDirectoryEndIndex,\n  )\n  const remainingDirectories = afterLastNodeModulesDirectory.split(\"/\")\n\n  if (afterLastNodeModulesDirectory[0] === \"@\") {\n    // scoped package\n    return `${projectDirectoryUrl}${beforeNodeModulesLastDirectory}${remainingDirectories\n      .slice(0, 2)\n      .join(\"/\")}`\n  }\n  return `${projectDirectoryUrl}${beforeNodeModulesLastDirectory}${remainingDirectories[0]}/`\n}\n\nconst magicExtensionWithImporterExtension = (magicExtensions, importer) => {\n  const importerExtension = urlToExtension(importer)\n  const magicExtensionsWithoutImporterExtension = magicExtensions.filter(\n    (ext) => ext !== importerExtension,\n  )\n  return [importerExtension, ...magicExtensionsWithoutImporterExtension]\n}\n",
    "export const importMapToVsCodeConfigPaths = ({ imports = {} }) => {\n  const paths = {}\n\n  Object.keys(imports).forEach((importKey) => {\n    const importValue = imports[importKey]\n\n    let key\n    if (importKey.endsWith(\"/\")) {\n      key = `${importKey}*`\n    } else {\n      key = importKey\n    }\n\n    const importValueArray =\n      typeof importValue === \"string\" ? [importValue] : importValue\n    const candidatesForPath = importValueArray.map((importValue) => {\n      if (importValue.endsWith(\"/\")) {\n        return `${importValue}*`\n      }\n      return importValue\n    })\n\n    if (key in paths) {\n      paths[key] = [...paths[key], ...candidatesForPath]\n    } else {\n      paths[key] = candidatesForPath\n    }\n  })\n\n  return paths\n}\n",
    "import { createLogger } from \"@jsenv/logger\"\nimport {\n  assertAndNormalizeDirectoryUrl,\n  writeFile,\n  resolveUrl,\n  readFile,\n  urlToFileSystemPath,\n} from \"@jsenv/filesystem\"\nimport { sortImportMap } from \"@jsenv/importmap\"\n\nimport { assertInitialImportMap } from \"./internal/assertInitialImportMap.js\"\nimport { packageConditionsFromPackageUserConditions } from \"./internal/package_conditions.js\"\nimport { visitNodeModuleResolution } from \"./internal/from-package/visitNodeModuleResolution.js\"\nimport { optimizeImportMap } from \"./internal/optimizeImportMap.js\"\nimport { resolveProjectEntryPoint } from \"./internal/from-js/resolveProjectEntryPoint.js\"\nimport { visitSourceFiles } from \"./internal/from-js/visitSourceFiles.js\"\nimport { importMapToVsCodeConfigPaths } from \"./internal/importMapToVsCodeConfigPaths.js\"\n\nexport const writeImportMapFiles = async ({\n  logLevel,\n  projectDirectoryUrl,\n  importMapFiles,\n  packagesManualOverrides,\n  onWarn = (warning, warn) => {\n    warn(warning)\n  },\n  writeFiles = true,\n  // for unit test\n  jsConfigFileUrl,\n}) => {\n  const logger = createLogger({ logLevel })\n  const warn = wrapWarnToWarnOnce((warning) => {\n    onWarn(warning, () => {\n      logger.warn(`\\n${warning.message}\\n`)\n    })\n  })\n\n  projectDirectoryUrl = assertAndNormalizeDirectoryUrl(projectDirectoryUrl)\n\n  if (typeof importMapFiles !== \"object\" || importMapFiles === null) {\n    throw new TypeError(\n      `importMapFiles must be an object, received ${importMapFiles}`,\n    )\n  }\n  const importMapFileRelativeUrls = Object.keys(importMapFiles)\n  const importMapFileCount = importMapFileRelativeUrls.length\n  if (importMapFileCount.length) {\n    throw new Error(`importMapFiles object is empty`)\n  }\n\n  const importMaps = {}\n  const nodeResolutionVisitors = []\n  importMapFileRelativeUrls.forEach((importMapFileRelativeUrl) => {\n    const importMapConfig = importMapFiles[importMapFileRelativeUrl]\n\n    const { initialImportMap = {} } = importMapConfig\n    assertInitialImportMap(initialImportMap)\n    const topLevelMappings = initialImportMap.imports || {}\n    const scopedMappings = initialImportMap.scopes || {}\n    const importMap = {\n      imports: topLevelMappings,\n      scopes: scopedMappings,\n    }\n    importMaps[importMapFileRelativeUrl] = importMap\n\n    const {\n      mappingsForNodeResolution,\n      mappingsForDevDependencies,\n      packageUserConditions,\n      packageIncludedPredicate,\n      runtime = \"browser\",\n    } = importMapConfig\n    if (mappingsForNodeResolution) {\n      nodeResolutionVisitors.push({\n        mappingsForDevDependencies,\n        packageConditions: packageConditionsFromPackageUserConditions({\n          runtime,\n          packageUserConditions,\n        }),\n        packageIncludedPredicate,\n        onMapping: ({ scope, from, to }) => {\n          if (scope) {\n            scopedMappings[scope] = {\n              ...(scopedMappings[scope] || {}),\n              [from]: to,\n            }\n          } else {\n            topLevelMappings[from] = to\n          }\n        },\n      })\n    }\n  })\n\n  if (nodeResolutionVisitors.length > 0) {\n    await visitNodeModuleResolution({\n      logger,\n      warn,\n      projectDirectoryUrl,\n      visitors: nodeResolutionVisitors,\n      packagesManualOverrides,\n    })\n  }\n\n  await importMapFileRelativeUrls.reduce(\n    async (previous, importMapFileRelativeUrl) => {\n      const importMapConfig = importMapFiles[importMapFileRelativeUrl]\n      const {\n        checkImportResolution,\n        // ideally we could enable extensionlessAutomapping and bareSpecifierAutomappingonly for a subset\n        // of files. Not that hard to do, especially using @jsenv/url-meta\n        // but that's super extra fine tuning that I don't have time/energy to do for now\n        bareSpecifierAutomapping,\n        extensionlessAutomapping,\n        magicExtensions,\n        removeUnusedMappings,\n        packageUserConditions,\n        runtime = \"browser\",\n      } = importMapConfig\n\n      if (\n        checkImportResolution ||\n        bareSpecifierAutomapping ||\n        extensionlessAutomapping ||\n        removeUnusedMappings\n      ) {\n        if (checkImportResolution === false) {\n          logger.warn(\n            `\"checkImportResolution\" cannot be disabled when automapping or \"removeUnusedMappings\" are enabled`,\n          )\n        }\n        if (extensionlessAutomapping && !magicExtensions) {\n          logger.warn(\n            `\"magicExtensions\" is required when \"extensionlessAutomapping\" is enabled`,\n          )\n        }\n\n        const projectEntryPoint = await resolveProjectEntryPoint({\n          warn,\n          projectDirectoryUrl,\n          packageUserConditions,\n        })\n\n        if (projectEntryPoint) {\n          const importMap = await visitSourceFiles({\n            logger,\n            warn,\n            projectDirectoryUrl,\n            projectEntryPoint,\n            importMap: importMaps[importMapFileRelativeUrl],\n            bareSpecifierAutomapping,\n            extensionlessAutomapping,\n            magicExtensions,\n            removeUnusedMappings,\n            runtime,\n          })\n          importMaps[importMapFileRelativeUrl] = importMap\n        }\n      }\n    },\n    Promise.resolve(),\n  )\n\n  Object.keys(importMaps).forEach((key) => {\n    const importMap = importMaps[key]\n    const importMapNormalized = sortImportMap(optimizeImportMap(importMap))\n    importMaps[key] = importMapNormalized\n  })\n\n  if (writeFiles) {\n    await importMapFileRelativeUrls.reduce(\n      async (previous, importMapFileRelativeUrl) => {\n        await previous\n        const importmapFileUrl = resolveUrl(\n          importMapFileRelativeUrl,\n          projectDirectoryUrl,\n        )\n        const importMap = importMaps[importMapFileRelativeUrl]\n        await writeFile(importmapFileUrl, JSON.stringify(importMap, null, \"  \"))\n        logger.info(`-> ${urlToFileSystemPath(importmapFileUrl)}`)\n      },\n      Promise.resolve(),\n    )\n  }\n\n  const firstUpdatingJsConfig = importMapFileRelativeUrls.find(\n    (importMapFileRelativeUrl) => {\n      const importMapFileConfig = importMapFiles[importMapFileRelativeUrl]\n      return importMapFileConfig.useForJsConfigJSON\n    },\n  )\n  if (firstUpdatingJsConfig) {\n    jsConfigFileUrl =\n      jsConfigFileUrl || resolveUrl(\"./jsconfig.json\", projectDirectoryUrl)\n    const jsConfigCurrent = (await readCurrentJsConfig(jsConfigFileUrl)) || {\n      compilerOptions: {},\n    }\n    const importMapUsedForVsCode = importMaps[firstUpdatingJsConfig]\n    const jsConfigPaths = importMapToVsCodeConfigPaths(importMapUsedForVsCode)\n    const jsConfig = {\n      ...jsConfigDefault,\n      ...jsConfigCurrent,\n      compilerOptions: {\n        ...jsConfigDefault.compilerOptions,\n        ...jsConfigCurrent.compilerOptions,\n        // importmap is the source of truth -> paths are overwritten\n        // We coudldn't differentiate which one we created and which one where added manually anyway\n        paths: jsConfigPaths,\n      },\n    }\n    await writeFile(jsConfigFileUrl, JSON.stringify(jsConfig, null, \"  \"))\n    logger.info(`-> ${urlToFileSystemPath(jsConfigFileUrl)}`)\n  }\n\n  return importMaps\n}\n\nconst wrapWarnToWarnOnce = (warn) => {\n  const warnings = []\n  return (warning) => {\n    const alreadyWarned = warnings.some((warningCandidate) => {\n      return JSON.stringify(warningCandidate) === JSON.stringify(warning)\n    })\n    if (alreadyWarned) {\n      return\n    }\n\n    if (warnings.length > 1000) {\n      warnings.shift()\n    }\n    warnings.push(warning)\n    warn(warning)\n  }\n}\n\nconst jsConfigDefault = {\n  compilerOptions: {\n    baseUrl: \".\",\n    paths: {},\n  },\n}\n\nconst readCurrentJsConfig = async (jsConfigFileUrl) => {\n  try {\n    const currentJSConfig = await readFile(jsConfigFileUrl, { as: \"json\" })\n    return currentJSConfig\n  } catch (e) {\n    return null\n  }\n}\n"
  ],
  "names": [
    "assertInitialImportMap",
    "value",
    "TypeError",
    "type",
    "imports",
    "scopes",
    "rest",
    "extraKeys",
    "Object",
    "keys",
    "length",
    "packageConditionsFromPackageUserConditions",
    "runtime",
    "packageUserConditions",
    "Array",
    "isArray",
    "forEach",
    "userCondition",
    "createPackageNameMustBeAStringWarning",
    "packageName",
    "packageInfo",
    "code",
    "message",
    "urlToFileSystemPath",
    "url",
    "createImportResolutionFailedWarning",
    "specifier",
    "importedBy",
    "gotBareSpecifierError",
    "magicExtension",
    "suggestsNodeRuntime",
    "automapping",
    "createDetailedMessage",
    "getImportResolutionFailedSuggestions",
    "createBareSpecifierAutomappingMessage",
    "mappingToImportmapString",
    "createExtensionLessAutomappingMessage",
    "mappingFoundInPackageExports",
    "suggestions",
    "addSuggestion",
    "suggestion",
    "suggestionCount",
    "mappingToUrlRelativeToFile",
    "mapping",
    "scope",
    "to",
    "scopeUrl",
    "resolveUrl",
    "toUrl",
    "urlToRelativeUrl",
    "from",
    "JSON",
    "stringify",
    "resolveFile",
    "fileUrl",
    "magicDirectoryIndexEnabled",
    "magicExtensionEnabled",
    "magicExtensions",
    "fileStat",
    "readFileSystemNodeStat",
    "nullIfNotFound",
    "isFile",
    "found",
    "isDirectory",
    "indexFileSuffix",
    "endsWith",
    "indexFileUrl",
    "result",
    "magicDirectoryIndex",
    "extension",
    "urlToExtension",
    "extensionLeadingToAFile",
    "findExtensionLeadingToFile",
    "urlDirectoryUrl",
    "urlFilename",
    "urlToFilename",
    "extensionLeadingToFile",
    "firstOperationMatching",
    "array",
    "start",
    "extensionCandidate",
    "urlCandidate",
    "stats",
    "predicate",
    "Boolean",
    "resolvePackageMain",
    "packageMain",
    "object",
    "main",
    "relativeUrlToTry",
    "urlFirstCandidate",
    "packageDirectoryUrl",
    "startsWith",
    "warning",
    "createPackageMainFileMustBeRelativeWarning",
    "createPackageMainFileNotFoundWarning",
    "relativeUrl",
    "join",
    "visitPackageImportMap",
    "warn",
    "packageImportmap",
    "importmap",
    "projectDirectoryUrl",
    "importmapFileUrl",
    "readFile",
    "as",
    "moveImportMap",
    "e",
    "createPackageImportMapNotFoundWarning",
    "createPackageImportMapUnexpectedWarning",
    "specifierIsRelative",
    "test",
    "visitPackageImports",
    "packageImports",
    "packageConditions",
    "importsSubpaths",
    "onImportsSubpath",
    "key",
    "trace",
    "createSubpathValueMustBeRelativeWarning",
    "valueTrace",
    "keyNormalized",
    "valueNormalized",
    "visitSubpathValue",
    "subpathValue",
    "subpathValueTrace",
    "handleString",
    "handleObject",
    "handleRemaining",
    "firstBareKey",
    "slice",
    "reverse",
    "find",
    "followConditionBranch",
    "conditionTrace",
    "bareKeys",
    "conditionalKeys",
    "availableKey",
    "push",
    "createSubpathKeysAreMixedWarning",
    "leadsToSomething",
    "some",
    "keyCandidate",
    "includes",
    "valueCandidate",
    "createSubpathIsUnexpectedWarning",
    "visitPackageExports",
    "packageExports",
    "exports",
    "name",
    "exportsSubpaths",
    "packageDirectoryRelativeUrl",
    "onExportsSubpath",
    "specifierToSource",
    "addressToDestination",
    "handleFalse",
    "handleNull",
    "firstRelativeKey",
    "relativeKeys",
    "exportsObjectFromExportsArray",
    "exportsArray",
    "exportsObject",
    "exportValue",
    "assign",
    "default",
    "address",
    "memoizeAsyncFunctionByUrl",
    "fn",
    "cache",
    "memoizeAsyncFunction",
    "getMemoryEntryFromArguments",
    "get",
    "set",
    "promise",
    "delete",
    "memoizeAsyncFunctionBySpecifierAndImporter",
    "importerCache",
    "importer",
    "specifierCacheForImporter",
    "memoized",
    "args",
    "memoryEntry",
    "promiseFromMemory",
    "resolve",
    "reject",
    "createControllablePromise",
    "error",
    "isInMemory",
    "Promise",
    "res",
    "rej",
    "PACKAGE_NOT_FOUND",
    "PACKAGE_WITH_SYNTAX_ERROR",
    "readPackageFile",
    "packageFileUrl",
    "packageObject",
    "console",
    "formatPackageSyntaxErrorLog",
    "syntaxError",
    "applyPackageManualOverride",
    "packagesManualOverrides",
    "version",
    "overrideKey",
    "overrideKeyCandidate",
    "composeObject",
    "leftObject",
    "rightObject",
    "composedObject",
    "rightValue",
    "leftValue",
    "createFindNodeModulePackage",
    "readPackageFileMemoized",
    "dependencyName",
    "nodeModuleCandidates",
    "getNodeModuleCandidates",
    "nodeModuleCandidate",
    "packageFileUrlCandidate",
    "packageObjectCandidate",
    "packageJsonObject",
    "fileDirectoryUrl",
    "fileDirectoryRelativeUrl",
    "candidates",
    "relativeNodeModuleDirectoryArray",
    "split",
    "shift",
    "i",
    "visitNodeModuleResolution",
    "logger",
    "visitors",
    "projectPackageFileUrl",
    "findNodeModulePackage",
    "seen",
    "markPackageAsSeen",
    "importerPackageFileUrl",
    "packageIsSeen",
    "visit",
    "packageVisitors",
    "packageImporterInfo",
    "filter",
    "visitor",
    "packageIncludedPredicate",
    "visitDependencies",
    "visitPackage",
    "dependencyMap",
    "packageDependenciesFromPackageObject",
    "all",
    "map",
    "dependencyInfo",
    "visitorsForDevDependencies",
    "mappingsForDevDependencies",
    "visitDependency",
    "dependencyData",
    "findDependency",
    "cannotFindPackageWarning",
    "createCannotFindPackageWarning",
    "isOptional",
    "debug",
    "dependencyPackageFileUrl",
    "dependencyPackageJsonObject",
    "packageDerivedInfo",
    "computePackageDerivedInfo",
    "addImportMapForPackage",
    "importMap",
    "packageIsRoot",
    "triggerVisitorOnMapping",
    "scopeMappings",
    "toMoved",
    "moveMappingValue",
    "scopeMoved",
    "addMappingsForPackageAndImporter",
    "mappings",
    "importerIsRoot",
    "importerRelativeUrl",
    "importsFromPackageField",
    "mappingsFromPackageImports",
    "mappingsFromPackageExports",
    "indexOf",
    "fromWithouTrailingStar",
    "toWithoutTrailingStar",
    "createExportsWildcardIgnoredWarning",
    "visitPackageMain",
    "packageDirectoryUrlExpected",
    "reduce",
    "previous",
    "mainResolutionInfo",
    "undefined",
    "mainFileRelativeUrl",
    "dependenciesCache",
    "dependencyPromise",
    "projectPackageObject",
    "Error",
    "lastIndexOf",
    "onMapping",
    "packageDependencies",
    "dependencies",
    "optionalDependencies",
    "versionPattern",
    "peerDependencies",
    "peerDependenciesMeta",
    "optional",
    "devDependencies",
    "hasOwnProperty",
    "importerPackageDirectoryUrl",
    "dependencyIsOptional",
    "dependencyType",
    "dependencyVersionPattern",
    "optimizeImportMap",
    "scopesOptimized",
    "scopeMappingsOptimized",
    "mappingKey",
    "topLevelMappingValue",
    "mappingValue",
    "entryPointResolutionFailureMessage",
    "resolveProjectEntryPoint",
    "projectPackageName",
    "projectPackageInfo",
    "reason",
    "tryExportSubpath",
    "exportSubpath",
    "packageSubpaths",
    "subpathKey",
    "packageMainResolutionInfo",
    "subpathUrl",
    "filesystemStat",
    "filenameContainsBackSlashes",
    "__filename",
    "replace",
    "require",
    "createRequire",
    "traverse",
    "parseImportSpecifiers",
    "urlResponseText",
    "babelOptions",
    "ast",
    "parseAsync",
    "sourceType",
    "filename",
    "plugins",
    "parserOpts",
    "ranges",
    "specifiers",
    "addSpecifier",
    "path",
    "node",
    "line",
    "loc",
    "column",
    "CallExpression",
    "callee",
    "arguments",
    "ExportAllDeclaration",
    "ExportNamedDeclaration",
    "source",
    "ImportDeclaration",
    "showSource",
    "showSourceLocation",
    "red",
    "grey",
    "ansiResetSequence",
    "numberOfSurroundingLinesToShow",
    "lineMaxLength",
    "color",
    "markColor",
    "asideColor",
    "colorMark",
    "string",
    "colorAside",
    "mark",
    "aside",
    "lines",
    "lineRange",
    "end",
    "moveLineRangeUp",
    "moveLineRangeDown",
    "lineRangeWithinLines",
    "linesToShow",
    "endLineNumber",
    "lineNumberMaxWidth",
    "String",
    "columnRange",
    "Math",
    "floor",
    "ceil",
    "lineSource",
    "index",
    "lineNumber",
    "isMainLine",
    "lineSourceTruncated",
    "applyColumnRange",
    "lineNumberWidth",
    "lineNumberRightSpacing",
    "repeat",
    "asideSource",
    "lineFormatted",
    "lineSourceUntilColumn",
    "spacing",
    "stringToSpaces",
    "mainLineFormatted",
    "prefix",
    "suffix",
    "lastIndex",
    "startTruncated",
    "endTruncated",
    "number",
    "visitSourceFiles",
    "projectEntryPoint",
    "bareSpecifierAutomapping",
    "extensionlessAutomapping",
    "removeUnusedMappings",
    "addMapping",
    "topLevelMappingsUsed",
    "scopedMappingsUsed",
    "markMappingAsUsed",
    "baseUrl",
    "fileUrlToHttpUrl",
    "loadOptionsAsync",
    "root",
    "importResolver",
    "createImportResolver",
    "onImportMapping",
    "performAutomapping",
    "visitUrl",
    "ignore",
    "body",
    "applyImportResolution",
    "visitUrlResponse",
    "httpUrlToFileUrl",
    "specifierInfo",
    "importsUsed",
    "scopesUsed",
    "mappingsUsed",
    "scopedMappings",
    "composeTwoImportMaps",
    "importMapNormalized",
    "normalizeImportMap",
    "BARE_SPECIFIER_ERROR",
    "isSpecifierForNodeCoreModule",
    "importUrl",
    "resolveImportUrl",
    "importFileUrl",
    "handleFileUrl",
    "handleHttpUrl",
    "resolveImport",
    "defaultExtension",
    "createBareSpecifierError",
    "foundFileUrl",
    "isJs",
    "httpUrl",
    "magicExtensionWithImporterExtension",
    "packageDirectoryUrlFromUrl",
    "extensionIsMappedInPackageExports",
    "moveUrl",
    "urlIsInsideOf",
    "closestPackageObject",
    "containsWildcard",
    "lastNodeModulesDirectoryStartIndex",
    "lastNodeModulesDirectoryEndIndex",
    "beforeNodeModulesLastDirectory",
    "afterLastNodeModulesDirectory",
    "remainingDirectories",
    "importerExtension",
    "magicExtensionsWithoutImporterExtension",
    "ext",
    "importMapToVsCodeConfigPaths",
    "paths",
    "importKey",
    "importValue",
    "importValueArray",
    "candidatesForPath",
    "writeImportMapFiles",
    "logLevel",
    "importMapFiles",
    "onWarn",
    "writeFiles",
    "jsConfigFileUrl",
    "createLogger",
    "wrapWarnToWarnOnce",
    "assertAndNormalizeDirectoryUrl",
    "importMapFileRelativeUrls",
    "importMapFileCount",
    "importMaps",
    "nodeResolutionVisitors",
    "importMapFileRelativeUrl",
    "importMapConfig",
    "initialImportMap",
    "topLevelMappings",
    "mappingsForNodeResolution",
    "checkImportResolution",
    "sortImportMap",
    "writeFile",
    "info",
    "firstUpdatingJsConfig",
    "importMapFileConfig",
    "useForJsConfigJSON",
    "jsConfigCurrent",
    "readCurrentJsConfig",
    "compilerOptions",
    "importMapUsedForVsCode",
    "jsConfigPaths",
    "jsConfig",
    "jsConfigDefault",
    "warnings",
    "alreadyWarned",
    "warningCandidate",
    "currentJSConfig"
  ],
  "mappings": "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"
}